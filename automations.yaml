- id: "1701111117565"
  alias: Report state on start-up
  trigger:
    - platform: homeassistant
      event: start
  action:
    - service: button.press
      continue_on_error: true
      target:
        entity_id: button.main_kiosk_load_start_url
    - service: button.press
      continue_on_error: true
      target:
        entity_id: button.ensuite_kiosk_load_start_url
    - delay:
        seconds: 3
    - service: script.browser_window_reload
    - delay:
        seconds: 3
    - service: frontend.set_theme
      data:
        name: Blue-Nightz
    - delay: 10
    - service: mqtt.publish
      data:
        topic: cmnd/sonoffs/backlog
        payload: power1 ; power2; power3; power4; power5; power6; dimmer; state
    - delay: 10
    - service: mqtt.publish
      data:
        topic: cmnd/tasmotas/backlog
        payload: power1 ; power2; power3; power4; power5; power6; dimmer; state
    - delay: 10
    - service: mqtt.publish
      data:
        topic: shellies/command
        payload: announce
  initial_state: true
- id: "1705577229915545"
  alias: Reload kiosk when lovelace is updated
  trigger:
    - platform: event
      event_type: lovelace_updated
  condition:
    - condition: state
      entity_id: input_boolean.kiosk_auto_refresh
      state: "on"
  action:
    - service: lovelace.reload_resources
    - delay: 6
    - service: button.press
      continue_on_error: true
      target:
        entity_id: button.ensuite_kiosk_load_start_url
    - choose:
        - conditions:
            - condition: state
              entity_id: switch.main_kiosk_screen
              state: "off"
          sequence:
            - service: switch.turn_on
              entity_id: switch.main_kiosk_screen
            - delay: 2
            - service: button.press
              target:
                entity_id: button.main_kiosk_load_start_url
        - conditions:
            - condition: state
              entity_id: switch.main_kiosk_screen
              state: "on"
          sequence:
            - delay: 2
            - service: button.press
              target:
                entity_id: button.main_kiosk_load_start_url
  mode: single
- id: "17016739887151444"
  alias: Reboot Kiosk
  trigger:
    - platform: device
      type: turned_off
      device_id: 17f117e87ed2ea44630be8afa72f7334
      entity_id: switch.main_kiosk_screen
      domain: switch
    - platform: state
      entity_id:
        - light.ac9b7f58_cfbfe785_screen
      to: "off"
  condition:
    - condition: time
      after: 05:00:00
      before: "23:59:01"
  action:
    - delay:
        minutes: 1
    - service: switch.turn_on
      target:
        entity_id: switch.main_kiosk_screen
    - delay: 3
    - service: light.turn_on
      target:
        entity_id: light.ac9b7f58_cfbfe785_screen
    - delay: 3
    - service: button.press
      target:
        entity_id: button.main_kiosk_load_start_url
  mode: single
- id: "17055555555545"
  alias: Create a notification when something is added to HACS
  initial_state: true
  trigger:
    platform: event
    event_type: hacs/repository
    event_data:
      action: registration
  condition:
    condition: template
    value_template: "{{ trigger.event.data.repository is defined }}"
  action:
    service: persistent_notification.create
    data_template:
      title: New repository in HACS
      message:
        "{% set repo = trigger.event.data.repository %} {% set id = trigger.event.data.repository_id
        %} [{{ repo }}](/hacs/repository/{{ id }}) was just added to HACS."
- id: "17066666666675"
  alias: Cuckoo Clock
  trigger:
    - platform: time_pattern
      hours: "*"
      minutes: "0"
    - platform: time_pattern
      minutes: "30"
  condition:
    - condition: state
      entity_id: input_boolean.cuckoo_clock
      state: "on"
    - condition: time
      after: 09:29:00
      before: "21:30:00"
    - condition: template
      value_template: |
        {% if is_state('media_player.family_tv', 'on') %}
          false
        {% else %}
          true
        {% endif %}
  action:
    - service: media_player.play_media
      data_template:
        entity_id: media_player.ac9b7f58_cfbfe785
        media_content_id: >-
          {% if now().strftime("%M")|int == 30 %}
          media-source://media_source/local/cuckoo-clock-01.wav {% else %}
          media-source://media_source/local/cuckoo-clock-{{now().strftime("%I")}}.wav
          {% endif %}
        media_content_type: music
  initial_state: true
- id: "170666736526675"
  alias: Grandfather Clock
  trigger:
    - platform: time_pattern
      hours: "*"
      minutes: "0"
    - platform: time_pattern
      minutes: "30"
  condition:
    - condition: state
      entity_id: input_boolean.grandfather_clock
      state: "on"
    - condition: time
      after: 09:29:00
      before: "21:30:00"
    - condition: template
      value_template: |
        {% if is_state('media_player.tv_speakers', 'on') %}
          false
        {% else %}
          true
        {% endif %}
  action:
    - service: media_player.play_media
      data_template:
        entity_id: media_player.tv_speakers
        media_content_id: >-
          {% if now().strftime("%M")|int == 15 %}
          media-source://media_source/local/gf-hour-15.mp3
          {% elif now().strftime("%M")|int == 30 %}
          media-source://media_source/local/gf-hour-30.mp3
          {% elif now().strftime("%M")|int == 45 %}
          media-source://media_source/local/gf-hour-45.mp3 {% else %}
          media-source://media_source/local/gf-hour-{{now().strftime("%I")}}.mp3
          {% endif %}
        media_content_type: music
  initial_state: true
- id: "170999999999458"
  alias: "[Notify] Smoke Detected"
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.nest_protect_hallway_smoke_status
        - binary_sensor.nest_protect_kitchen_smoke_status
      to: "on"
      for:
        seconds: 5
  action:
    - service: noonlight.create_alarm
      data:
        service: fire
    - service: climate.turn_off
      target:
        entity_id: climate.den
    - service: switch.turn_off
      entity_id:
        - switch.dryer_plug
    - service: light.turn_on
      target:
        entity_id: light.every_light
    - service: notify.notify_all
      data_template:
        message: "{{ trigger.to_state.attributes.friendly_name }} smoke detected ðŸ”¥ "
        title: Smoke Alarm
        data:
          channel: alert
          group: alert
          sticky: true
          importance: high
          notification_icon: "mdi:smoke-detector-variant-alert"
  initial_state: true
- id: "17019999999957"
  alias: "[Notify] Water Heater Leak"
  initial_state: true
  trigger:
    - platform: state
      entity_id: binary_sensor.water_heater
      to: "on"
  action:
    - service: script.water_heater_leak
- id: "170299999999"
  alias: "[Notify] Washing Machine Leak"
  initial_state: true
  trigger:
    - platform: state
      entity_id: binary_sensor.washer_leak
      to: "on"
  action:
    - service: homeassistant.turn_off
      entity_id:
        - switch.washer_plug
    - service: script.washer_leak
- id: "17049999999965"
  alias: "[Notify] Garage Fridge OFF"
  initial_state: true
  trigger:
    - platform: state
      entity_id: switch.garage_fridge_relay
      to: "off"
      for:
        minutes: 2
  action:
    - service: notify.mobile_app_pixel_8_pro
      data_template:
        message: "Garage fridge turned off at '{{ now().strftime('%I:%M %p') }}' "
    - delay: 00:15:00
    - service: homeassistant.turn_on
      entity_id: switch.garage_fridge_relay
    - service: notify.mobile_app_pixel_8_pro
      data_template:
        message: "Garage fridge turned back on at '{{ now().strftime('%I:%M %p') }}' "
- id: "17059999999941"
  alias: Update Template Sensors
  initial_state: true
  trigger:
    platform: time_pattern
    minutes: /59
  action:
    - service: homeassistant.update_entity
      entity_id:
        - sensor.tracker_count
        - sensor.lights_count
        - sensor.binary_sensor_count
        - sensor.switch_count
        - sensor.automation_count
        - sensor.script_count
        - sensor.sensor_count
        - sensor.alert_count
        - sensor.fan_count
- id: "17069999999922"
  alias: "[Tablet] background morning"
  initial_state: true
  trigger:
    platform: time
    at: 06:30:00
  action:
    - service: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - christian41.1
          - coffee1_11
          - coffee1_21
          - wallpaper7e
          - coffee1_31
          - coffee1_41
          - coffee1_51
          - coffee1_61
          - coffee1_71
    - service:
        script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}
- id: "17079999999911"
  alias: "[Tablet] background midday"
  initial_state: true
  trigger:
    platform: time
    at: "10:00:00"
  action:
    - service: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - christian1.1
          - wallpaper13
          - wallpaper7e
          - wallpaper66
          - christian21
          - wallpaper141
          - wallpaper33
          - christian31
          - wallpaper21
          - christian41.1
          - christian5
          - christian61
          - christian7.1
    - service:
        script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}
- id: "17089999999955"
  alias: "[Tablet] background evening"
  initial_state: true
  trigger:
    platform: time
    at: "16:00:00"
  action:
    - service: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - wallpaper141
          - wallpaper1
          - wallpaper13
          - wallpaper7e
          - wallpaper66
          - eye11
          - christian21
          - wallpaper121
          - ufo1
          - christian5
          - welcome4
          - christian1.1
          - wallpaper5
    - service:
        'script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}'
- id: "17091999999944"
  alias: "[Tablet] background night"
  initial_state: true
  trigger:
    platform: time
    at: "19:00:00"
  action:
    - service: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - christian41.1
          - wallpaper13
          - moonFull
          - christian31
          - wallpaper7e
          - wallpaper141
          - moon2Blue
          - wallpaper66
          - wallpaper1
          - christian21
          - wallpaper21
          - moonLake
    - service:
        script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}
- id: "17092999999977"
  alias: "[Tablet] background select"
  initial_state: true
  trigger:
    platform: time_pattern
    minutes: /7
  action:
    - service: input_select.select_next
      entity_id: input_select.wallpaper
    - service:
        'script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}'
- id: "17093999999988"
  alias: "[Mobile] background select"
  initial_state: true
  trigger:
    platform: time_pattern
    minutes: /5
  action:
    - service: input_select.select_next
      entity_id:
        - input_select.mobile_wallpaper
        - input_select.video_wallpaper
        - input_select.rambo_pics
- id: "17094999999944"
  alias: "[Tablet] motion_ON"
  initial_state: true
  trigger:
    - platform: state
      entity_id:
        - light.den_nite_lites
      to: "on"
  condition:
    - condition: time
      after: 05:30:00
      before: "23:00:00"
  action:
    - service: switch.turn_on
      data:
        entity_id: switch.main_kiosk_screen
    - service: light.turn_on
      data:
        entity_id: light.ac9b7f58_cfbfe785_screen
    - service: browser_mod.navigate
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/newtab
- id: "17095999999922"
  alias: "[Tablet] motion_OFF_night"
  initial_state: true
  trigger:
    - platform: state
      entity_id: light.den_nite_lites
      to: "off"
      for:
        minutes: 15
  condition:
    - condition: time
      after: "22:30:01"
      before: 05:30:00
  action:
    - service: switch.turn_off
      data:
        entity_id: switch.main_kiosk_screen
- id: "17096999999966"
  alias: "[Tablet] motion_OFF_day"
  initial_state: true
  trigger:
    - platform: state
      entity_id: light.den_nite_lites
      from: "on"
      to: "off"
  condition:
    - condition: time
      after: 05:30:01
      before: "22:30:00"
    - condition: state
      entity_id: binary_sensor.den_motion_sensors
      state: "off"
  action:
    - delay: 300
    - service: browser_mod.navigate
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/random
    - delay: 600
    - service: browser_mod.navigate
      data:
        path: /lovelace/screen
        browser_id:
          - ac9b7f58-cfbfe785
  mode: restart
  max_exceeded: silent

- id: "17099299999977"
  alias: "[Tablet] Toggle tablet icons color"
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_boolean.tablet_icons_color
  action:
    - service: homeassistant.turn_{{- trigger.to_state.state -}}
      data:
        entity_id: group.tablet_icons
- id: "17099939999933322"
  alias: "[Motion] Porch Motion Lights after Dark"
  trigger:
    - platform: state
      entity_id: binary_sensor.front_motion
      from: "off"
      to: "on"
    - platform: device
      device_id: 011d22447a45c26939459e4d099889cb
      domain: nest
      type: camera_person
    - platform: device
      device_id: 011d22447a45c26939459e4d099889cb
      domain: nest
      type: camera_motion
  condition:
    - condition: or
      conditions:
        - condition: sun
          after: sunset
          after_offset: 45
        - condition: sun
          before: sunrise
          before_offset: 45
  action:
    - service: light.turn_on
      entity_id:
        - light.ha2_porch_light
        - light.front_yard_cam_floodlight
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.front_motion
        from: "on"
        to: "off"
    - delay: 600
    - service: light.turn_off
      entity_id:
        - light.ha2_porch_light
        - light.front_yard_cam_floodlight
  mode: restart
  max_exceeded: silent

- id: "170999978999162"
  alias: "[Presence] Darren Away"
  trigger:
    - platform: state
      entity_id:
        - person.darren
      to: not_home
      for:
        minutes: 4
  action:
    - service: input_boolean.turn_on
      entity_id: input_boolean.camera_snapshots
    - service: homeassistant.turn_off
      continue_on_error: true
      entity_id:
        - input_boolean.darren_home
        - light.office_lights
        - switch.ha2_office_monitor
        - fan.hallway_fan
        - switch.ha2_work_bench
        - switch.keurig_coffee
  initial_state: true
  mode: single
- id: "170999979999163"
  alias: "[Presence] Darren Home"
  trigger:
    - platform: state
      entity_id:
        - person.darren
      to: home
      for:
        seconds: 12
  action:
    - service: homeassistant.turn_on
      continue_on_error: true
      entity_id:
        - input_boolean.darren_home
        - light.office_floor_lights
        - fan.hallway_fan
        - switch.ha2_office_monitor
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "on"
          sequence:
            - service: light.turn_on
              entity_id: light.outside_lights
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "off"
          sequence:
            - service: light.turn_on
              entity_id: light.entry_hall_lights
    - choose:
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: closed
          sequence:
            - service: switch.turn_on
              entity_id: switch.garage_door
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: open
          sequence:
            - service: light.turn_on
              entity_id: light.garage_ceiling_lights
    - delay: 180
    - service: input_boolean.turn_off
      entity_id:
        - input_boolean.camera_snapshots
  initial_state: true
  mode: single
- id: "170999979999641209"
  alias: "[Presence] Donna Home"
  trigger:
    - platform: state
      entity_id:
        - person.donna
      to: home
      for:
        seconds: 12
  action:
    - service: input_boolean.turn_on
      entity_id: input_boolean.donna_home
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "on"
          sequence:
            - service: light.turn_on
              entity_id: light.outside_lights
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "off"
          sequence:
            - service: light.turn_on
              entity_id: light.entry_hall_lights
    - choose:
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: closed
          sequence:
            - service: switch.turn_on
              entity_id: switch.garage_door
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: open
          sequence:
            - service: light.turn_on
              entity_id: light.garage_ceiling_lights
  initial_state: true
  mode: single
- id: "170999989999524"
  alias: "[Presence] Donna Away"
  trigger:
    - platform: state
      entity_id:
        - person.donna
      to: not_home
      for:
        minutes: 2
  action:
    - service: input_boolean.turn_off
      entity_id: input_boolean.donna_home
    - delay: 300
  mode: single
  initial_state: true
  max_exceeded: silent
- id: "17026181774975342345"
  alias: "[SWITCH] Outside Lights"
  trigger:
    - platform: state
      entity_id:
        - switch.patio_box_fan_switch
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - service: homeassistant.turn_{{- trigger.to_state.state -}}
      data:
        entity_id: light.outside_lights
  initial_state: true
- id: "170999993999165"
  alias: "[Presence] People Away"
  trigger:
    - platform: state
      entity_id: group.person_group
      to: not_home
      for:
        seconds: 180
  action:
    - service: script.alarm_arm
    - service: script.people_away
    - service: switch.turn_off
      data:
        entity_id: switch.main_kiosk_screen
    - delay: 300
  mode: single
  max_exceeded: silent
- id: "170999994999166"
  alias: "[Presence] People Home"
  trigger:
    - platform: state
      entity_id: group.person_group
      to: home
      for:
        seconds: 8
  action:
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.alarmo
      data:
        code: 3971
    - choose:
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: closed
          sequence:
            - service: switch.turn_on
              entity_id: switch.garage_door
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: open
          sequence:
            - service: light.turn_on
              entity_id: light.garage_ceiling_lights
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "on"
          sequence:
            - service: light.turn_on
              entity_id: light.outside_lights
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "off"
          sequence:
            - service: light.turn_on
              entity_id: light.entry_hall_lights
    - service: script.people_home
    - service: switch.turn_on
      data:
        entity_id: switch.main_kiosk_screen
    - service: light.turn_on
      data:
        entity_id: light.ac9b7f58_cfbfe785_screen
    - service: browser_mod.navigate
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/newtab
    - choose:
        - conditions:
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - delay: 360
            - service: light.turn_off
              entity_id: light.outside_lights
        - conditions:
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
          sequence:
            - delay: 1200
            - service: light.turn_off
              entity_id: light.outside_lights
  mode: single
  max_exceeded: silent
- id: "170999995999164"
  alias: "[Timer] office fan off"
  initial_state: true
  trigger:
    - platform: state
      entity_id: fan.office_fan
      to: "on"
  action:
    #    - delay:
    #        "{{ states('input_number.office_fan_hours') | int }}:{{ states('input_number.office_fan_minutes')
    #        | int }}:{{ states('input_number.office_fan_seconds') | int }}"
    - service: timer.start
      data:
        duration: >-
          {{ states.input_number.office_fan_duration.state | int(0) * 60 }}
      target:
        entity_id:
          - timer.office_fan_timer
    - wait_for_trigger:
        platform: state
        entity_id: timer.office_fan_timer
        from: active
        to: idle
    - service: fan.turn_off
      entity_id: fan.office_fan
- id: "17099999919856349"
  alias: "[Notify] Coffee Maker ON"
  initial_state: true
  trigger:
    - platform: state
      entity_id: switch.coffee_maker
      to: "on"
  action:
    - service: homeassistant.turn_on
      entity_id: light.coffee_light
    - service: notify.mobile_app_pixel_8_pro
      data_template:
        title: âš ï¸Coffeeâ˜•ï¸ Maker ON
        message: " at {{ states('sensor.time_12_hour_am_pm') }}"
- id: "170999999299876354"
  alias: "[TIMER] Fountain"
  trigger:
    - platform: time
      at: "20:00:00"
  action:
    - service: switch.turn_on
      target:
        entity_id: switch.fountain_switch
    - delay: 600
    - service: switch.turn_off
      target:
        entity_id: switch.fountain_switch
  initial_state: true
- id: "170999999799168"
  alias: "[Motion] Kitchen Motion Lights"
  trigger:
    - platform: state
      entity_id: binary_sensor.kitchen_motion_sensors
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "on"
  action:
    - service: light.turn_on
      entity_id: light.kitchen_ceiling_lights
    - service: mqtt.publish
      data:
        topic: cmnd/cabinets/power1
        payload: "ON"
        retain: "true"
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.kitchen_motion_sensors
        from: "on"
        to: "off"
    - delay: 720
    - service: light.turn_off
      entity_id: light.kitchen_ceiling_lights
    - service: mqtt.publish
      data:
        topic: cmnd/cabinets/power1
        payload: "OFF"
        retain: "true"
  mode: restart
  max_exceeded: silent
- id: "1701618177497534"
  alias: "[Motion] Entryway Motion Lights"
  description: ""
  trigger:
    - platform: state
      entity_id: binary_sensor.entryway_motion
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "on"
  action:
    - service: light.turn_on
      entity_id: light.entry_hall_lights
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.entryway_motion
        from: "on"
        to: "off"
    - delay: 10
    - service: light.turn_off
      entity_id: light.entry_hall_lights
  mode: restart
  max_exceeded: silent
- id: "1706618177497534"
  alias: "[Auto] Hall Bath Vent auto off timer"
  trigger:
    - platform: state
      entity_id: switch.bathroom_vent
      to: "on"
      for:
        minutes: 15
  action:
    - service: switch.turn_off
      entity_id: switch.bathroom_vent
  initial_state: true
- id: "17086148177497534"
  alias: "[Auto] Turn bathroom vent when humidity goes up/down"
  trigger:
    - platform: numeric_state
      entity_id: sensor.bathroom_humidity_2
      above: 60
    - platform: numeric_state
      entity_id: sensor.bathroom_humidity_2
      below: 59
  action:
    - service_template: |
        {% if states('sensor.bathroom_humidity_2')|float > 60 %}
          switch.turn_on
        {% elif states('sensor.bathroom_humidity_2')|float < 59 %}
          switch.turn_off
        {% endif %}
      entity_id: switch.bathroom_vent
  initial_state: true
- id: "17096181717497534"
  alias: "[Auto] Turn ensuite vent when humidity goes up/down"
  trigger:
    - platform: numeric_state
      entity_id: sensor.ensuite_humidity_2
      above: 60
    - platform: numeric_state
      entity_id: sensor.ensuite_humidity_2
      below: 59
  condition:
    - condition: state
      entity_id: light.jacuzzi_light
      state: "off"
      enabled: true
    - condition: numeric_state
      entity_id: sensor.ensuite_temperature_2
      above: 70
  action:
    - service_template: |
        {% if states('sensor.ensuite_humidity_2')|float > 60 %}
          switch.turn_on
        {% elif states('sensor.ensuite_humidity_2')|float < 59 %}
          switch.turn_off
        {% endif %}
      entity_id: switch.ensuite_vent
  initial_state: true
- id: "17016381774975134"
  alias: "[Auto] Ensuite Vent auto off timer"
  trigger:
    - platform: state
      entity_id: switch.ensuite_vent
      to: "on"
      for:
        minutes: 15
  action:
    - service: switch.turn_off
      entity_id: switch.ensuite_vent
  initial_state: true
- id: "17016185774975347"
  alias: "[Notify] Auto Notifications ON"
  trigger:
    - platform: time
      at: "23:00:00"
  action:
    - service: input_boolean.turn_on
      entity_id:
        - input_boolean.camera_snapshots
        - input_boolean.motion_lights
        - input_boolean.door_announcements
        - input_boolean.disable_laundry_notifications
    - service: input_boolean.turn_off
      entity_id:
        - input_boolean.disable_popups
        - input_boolean.auto_tablet
        - input_boolean.auto_backgroundz
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: "âš ï¸ï¸Notifications\U0001F4E2 turned ON"
  initial_state: true
  mode: single
- id: "17016518677497534"
  alias: Washer State - Start
  initial_state: true
  trigger:
    - platform: numeric_state
      entity_id: sensor.washer_plug_energy_power
      above: 4
      for:
        minutes: 4
  condition:
    - condition: template
      value_template: "{{ states.sensor.washer_state.state != 'Washing' }}"
  action:
    - service: mqtt.publish
      data:
        topic: hass/state/washer
        payload: Washing
        retain: "true"
- id: "17016187747497534"
  alias: Washer State - Idle
  initial_state: true
  trigger:
    - platform: numeric_state
      entity_id: sensor.washer_plug_energy_power
      below: 5
      for:
        minutes: 4
  action:
    - service: mqtt.publish
      data:
        topic: hass/state/washer
        payload: Idle
        retain: "true"
- id: "17016188774927534"
  alias: "Washing finished"
  initial_state: true
  trigger:
    - platform: state
      entity_id: sensor.washer_state
      from: Washing
      to: Idle
  condition:
    - condition: state
      entity_id: input_boolean.disable_laundry_notifications
      state: "off"
  action:
    - service: media_player.volume_set
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.50"
    - service: tts.google_say
      entity_id: media_player.tv_speakers
      data_template:
        message: Donna or Darren..,,Clothes ready..,The washing machine has finished!
    - service: notify.pixels_and_den_tv
      data_template:
        message: "WashingðŸ‘•ðŸ‘—ðŸ‘–Finished {{ states('sensor.time_12_hour_am_pm') }}"
- id: "17016189747497534"
  alias: Dryer State - Drying
  initial_state: true
  trigger:
    - platform: numeric_state
      entity_id: sensor.dryer_energy_power
      above: 50
      for:
        minutes: 4
  action:
    - service: mqtt.publish
      data:
        topic: hass/state/dryer
        payload: Drying
        retain: "true"
- id: "17011181757497534"
  alias: Dryer State - Idle
  initial_state: true
  trigger:
    - platform: numeric_state
      entity_id: sensor.dryer_energy_power
      below: 6
      for:
        minutes: 1
  action:
    - service: mqtt.publish
      data:
        topic: hass/state/dryer
        payload: Idle
        retain: "true"
- id: "17012181747497534"
  alias: "Drying Finished"
  initial_state: true
  trigger:
    - platform: state
      entity_id: sensor.dryer_state
      from: Drying
      to: Idle
  condition:
    - condition: state
      entity_id: input_boolean.disable_laundry_notifications
      state: "off"
  action:
    - service: media_player.volume_set
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.50"
    - service: tts.google_say
      entity_id: media_player.tv_speakers
      data_template:
        message: Donna or Darren..,Clothes are ready..,The dryer has finished!
    - service: notify.pixels_and_den_tv
      data_template:
        message: "DryingðŸ‘•ðŸ‘—ðŸ‘–Finished {{ states('sensor.time_12_hour_am_pm') }}"
- id: "170181817174975343345"
  alias: "[Alarmo] Triggered"
  initial_state: true
  trigger:
    - platform: state
      entity_id: alarm_control_panel.alarmo
      to: triggered
  action:
    - service: notify.mobile_app_pixel_8_pro
      continue_on_error: true
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: "The alarm has been triggered by {{ dict((states|selectattr('entity_id', 'in', state_attr('group.monitored_contacts', 'entity_id'))|list)|groupby('state'))['on']|map(attribute='name')|list|join(', ') }}"
    - service: notify.mobile_app_pixel_5
      continue_on_error: true
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: "The alarm has been triggered by {{ dict((states|selectattr('entity_id', 'in', state_attr('group.monitored_contacts', 'entity_id'))|list)|groupby('state'))['on']|map(attribute='name')|list|join(', ') }}"
    - service: switch.turn_on
      continue_on_error: true
      entity_id: switch.siren
    - service: noonlight.create_alarm
      continue_on_error: true
      data:
        service: police
    - service: light.turn_on
      continue_on_error: true
      entity_id: light.every_light
    - service: light.turn_on
      continue_on_error: true
      entity_id: light.outside_lights
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.90"
    - delay: "00:00:01"
    - service: tts.google_say
      data:
        cache: true
        entity_id: media_player.tv_speakers
      data_template:
        message: "Alarm triggered! Police has been notified! at {{ states('sensor.time_12_hour_am_pm') }}"
- id: "17016111774977534"
  alias: "[Alarmo] Away Mode Armed"
  initial_state: true
  trigger:
    - platform: state
      entity_id: alarm_control_panel.alarmo
      to: armed_away
  action:
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: Security system activated.
- id: "1701177486112975382884"
  alias: "[Alarmo] Disarmed"
  initial_state: true
  trigger:
    - platform: state
      entity_id: alarm_control_panel.alarmo
      to: disarmed
  action:
    - delay: 5
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: Security system has been deactivated.
- id: "1701612177497534"
  alias: "[Alarmo] Home Mode Armed"
  initial_state: true
  trigger:
    - platform: state
      entity_id: alarm_control_panel.alarmo
      to: armed_home
  action:
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: Security system activated.
#    - service: script.home_mode_armed
- id: "17016131774975342345"
  alias: "[Alarmo] Disarmed and alarm-switch"
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_disarm_switch
      to: "on"
    - platform: state
      entity_id: alarm_control_panel.alarmo
      from: triggered
      to: disarmed
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: input_boolean.alarm_disarm_switch
              state: "on"
          sequence:
            - service: alarm_control_panel.alarm_disarm
              entity_id: alarm_control_panel.alarmo
              data:
                code: !secret alarm_code
            - service: input_boolean.turn_off
              entity_id: input_boolean.alarm_disarm_switch
        - conditions:
            - condition: state
              entity_id: alarm_control_panel.alarmo
              state: disarmed
          sequence:
            - service: switch.turn_off
              continue_on_error: true
              entity_id:
                - switch.noonlight_switch
                - switch.siren
            - service: light.turn_off
              continue_on_error: true
              entity_id:
                - light.every_light
                - light.outside_lights
            - service: notify.pixels_and_den_tv
              data_template:
                message: "Alarm canceled at {{ states('sensor.time_12_hour_am_pm') }}"
            - delay: 3
            - service: light.turn_on
              continue_on_error: true
              entity_id:
                - light.ha2_sofa_lamp
                - light.cabinet_lights
- id: "1701613174749753434567"
  alias: "[Alarmo] Home mode switch"
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_arm_home_switch
      to: "on"
  action:
    - service: script.alarm_arm_home
- id: "1701613117749753498765432"
  alias: "[Alarmo] Away mode switch"
  initial_state: true
  trigger:
    - platform: state
      entity_id: input_boolean.alarm_arm_away_switch
      to: "on"
  action:
    - service: script.alarm_arm
- id: "17016161677497534"
  alias: "[Alarmo] Auto Night Arm"
  initial_state: true
  trigger:
    - platform: time
      at: "23:56:00"
  condition:
    - condition: state
      entity_id: alarm_control_panel.alarmo
      state: disarmed
  action:
    - choose:
        - conditions:
            - condition: time
              weekday:
                - fri
                - sat
          sequence:
            - service: notify.mobile_app_pixel_8_pro
              continue_on_error: true
              data:
                message: TTS
                data:
                  ttl: 0
                  priority: high
                  tts_text: The alarm will be activated in three minutes.
            - delay: 180
            - service: script.alarm_arm_home
        - conditions:
            - condition: time
              weekday:
                - sun
                - mon
                - tue
                - wed
                - thu
          sequence:
            - delay: 180
            - service: script.alarm_arm_home
- id: "17071774947534873644"
  alias: "[Alarmo] Someone's awake Disarm alarm"
  mode: single
  trigger:
    - platform: state
      entity_id: input_boolean.darren_is_awake
      to: "on"
    - platform: state
      entity_id: input_boolean.donna_is_awake
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.morning_triggered_today
      state: "off"
    - condition: time
      after: "06:00:00"
      before: "11:00:00"
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: and
      conditions:
        - condition: or
          conditions:
            - condition: device
              device_id: 796b669c1f2c31677ae6e0a838928d34
              domain: alarm_control_panel
              entity_id: alarm_control_panel.alarmo
              type: is_armed_home
            - condition: device
              device_id: 796b669c1f2c31677ae6e0a838928d34
              domain: alarm_control_panel
              entity_id: alarm_control_panel.alarmo
              type: is_armed_night
  action:
    - wait_for_trigger:
        - platform: state
          entity_id:
            - binary_sensor.den_main_motion
          from: "off"
          to: "on"
        - platform: state
          entity_id:
            - binary_sensor.kitchen_motion_sensors
          from: "off"
          to: "on"
    - service: script.morning
  initial_state: true
- id: "17016181157497534"
  alias: Notify us when the garage door opens and no one home
  trigger:
    - platform: state
      entity_id: group.person_group
      to: not_home
      for:
        minutes: 3
  condition:
    - condition: state
      entity_id: cover.garage_door
      state: open
  action:
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: The garage is open.
    - delay: 5
    - service: notify.notify_all
      data:
        message: The garage is open and no one is home!!!
        data:
          color: red
          actions:
            - action: close_garage
              title: Close Garage Door
        title: GARAGE IS OPEN
- id: "17016181274497534"
  alias: Close the garage when notification action is tapped
  trigger:
    platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: close_garage
  action:
    service: cover.close_cover
    entity_id: cover.garage_door
- id: "17016181237497534"
  alias: Notify when desk light goes off
  trigger:
    - platform: state
      entity_id:
        - light.desk_light
      to: "off"
  condition:
    - condition: state
      entity_id: person.darren
      state: not_home
  action:
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: Desk light off
        data:
          color: red
          actions:
            - action: turn_on
              title: Turn light on
- id: "17016181474697534"
  alias: Turn desk light on when notification action is tapped
  trigger:
    platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: turn_on
  action:
    service: light.turn_on
    entity_id: light.desk_light
- id: "17016181374977534434343"
  alias: Notify when AC unit goes off
  trigger:
    - platform: state
      entity_id:
        - climate.den
      to: "off"
      for:
        minutes: 1
  action:
    - service: notify.notify_all
      data:
        message: A/C Unit is off
        data:
          color: red
          actions:
            - action: turn_on_ac
              title: Turn AC on
- id: "17016181474947534545454"
  alias: Turn AC unit on when notification action is tapped
  trigger:
    platform: event
    event_type: mobile_app_notification_action
    event_data:
      action: turn_on_ac
  action:
    - delay: 00:05:00
    - service: homeassistant.turn_on
      entity_id: climate.den
- id: "17016499927893058"
  alias: Update notifications
  use_blueprint:
    path: mdegat01/update_notifications.yaml
    input:
      reminder_hours: "3"
      update_entities:
        - update.docker_wyze_bridge_update
        - update.home_assistant_core_update
        - update.home_assistant_google_drive_backup_update
        - update.home_assistant_operating_system_update
        - update.home_assistant_supervisor_update
        - update.zerotier_one_update
        - update.mariadb_update
        - update.network_ups_tools_update
        - update.mosquitto_broker_update
        - update.nginx_home_assistant_ssl_proxy_update
        - update.silicon_labs_multiprotocol_update
        - update.studio_code_server_update
      mobile_app_device: 5402f427ac93601eeab00b7fc7d6f6da
      send_to_ha: true
      take_backup: false
      only_before: "23:00:00"
      only_after: 07:00:00
      run_config_check: false
      mobile_app_device_2: fcffc10d5913eb61a8616787b322450e
- id: "17016506815125772"
  alias: UPS Power OFF
  trigger:
    - type: voltage
      platform: device
      device_id: ce3cd90f8063fc682a2d4d1767be5165
      entity_id: sensor.mainups_input_voltage
      domain: sensor
      below: 10
  action:
    - service: notify.darren
      data:
        message: The Power went OFF at {{ states('sensor.time_12_hour_am_pm') }}
        title: Smart Home Alert
  mode: single
- id: "17016506828368235"
  alias: UPS Online and fully charged
  trigger:
    - type: battery_level
      platform: device
      device_id: ce3cd90f8063fc682a2d4d1767be5165
      entity_id: sensor.mainups_battery_charge
      domain: sensor
      above: 99
  condition:
    - type: is_voltage
      condition: device
      device_id: ce3cd90f8063fc682a2d4d1767be5165
      entity_id: sensor.mainups_input_voltage
      domain: sensor
      above: 120
  action:
    - service: notify.darren
      data:
        title: Smart Home Alert
        message:
          UPS is online and fully charged at {{ states('sensor.time_12_hour_am_pm')
          }}
  mode: single
- id: "170165068283468355"
  alias: UPS changed state
  trigger:
    - platform: event
      event_type: nut.ups_event
  action:
    - service: notify.mobile_app_pixel_8_pro
      data_template:
        title: UPS changed state
        message: "{{ trigger.event.data.notify_msg }}"
- id: "17016545649719910"
  alias: Donna left work turn on AC
  trigger:
    - platform: zone
      entity_id: person.donna
      zone: zone.donna_s_work
      event: leave
  condition:
    - condition: numeric_state
      entity_id: sensor.patio_temperature_2
      above: 76
    - condition: state
      entity_id: group.person_group
      state: not_home
  action:
    - service: climate.set_temperature
      data:
        temperature: 76
        hvac_mode: cool
      target:
        entity_id:
          - climate.den
  mode: single
- id: "17016646577672587"
  alias: Bedroom Fan Low
  trigger:
    - platform: state
      entity_id:
        - input_boolean.bedroom_fan_low
      from: "off"
      to: "on"
  action:
    - service: script.bedroom_fan_low
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.bedroom_fan_low
  mode: single
- id: "17016646861505822"
  alias: Bedroom Fan Medium
  trigger:
    - platform: state
      entity_id:
        - input_boolean.bedroom_fan_medium
      from: "off"
      to: "on"
  action:
    - service: script.bedroom_fan_medium
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.bedroom_fan_medium
  mode: single
- id: "17016654686576228"
  alias: Bedroom Fan High
  trigger:
    - platform: state
      entity_id:
        - input_boolean.bedroom_fan_high
      from: "off"
      to: "on"
  action:
    - service: script.bedroom_fan_high
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.bedroom_fan_high
  mode: single
- id: "17016646786640111"
  alias: Bedroom Fan Max
  trigger:
    - platform: state
      entity_id:
        - input_boolean.bedroom_fan_max
      from: "off"
      to: "on"
  action:
    - service: script.bedroom_fan_max
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.bedroom_fan_max
  mode: single
- id: "1701664617767258723"
  alias: Office Fan Low
  trigger:
    - platform: state
      entity_id:
        - input_boolean.office_fan_low
      from: "off"
      to: "on"
  action:
    - service: script.office_fan_low
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.office_fan_low
  mode: single
- id: "1701664628650582276"
  alias: Office Fan Medium
  trigger:
    - platform: state
      entity_id:
        - input_boolean.office_fan_medium
      from: "off"
      to: "on"
  action:
    - service: script.office_fan_medium
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.office_fan_medium
  mode: single
- id: "1701664868657622838"
  alias: Office Fan High
  trigger:
    - platform: state
      entity_id:
        - input_boolean.office_fan_high
      from: "off"
      to: "on"
  action:
    - service: script.office_fan_high
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.office_fan_high
  mode: single
- id: "17016464686640111334"
  alias: Office Fan Max
  trigger:
    - platform: state
      entity_id:
        - input_boolean.office_fan_max
      from: "off"
      to: "on"
  action:
    - service: script.office_fan_max
    - delay:
        seconds: 3
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.office_fan_max
  mode: single
- id: "17016703383649836"
  alias: TV Ambient lights ON when TV is on
  trigger:
    - platform: state
      entity_id:
        - remote.den_tv
      to: "on"
  action:
    - service: homeassistant.turn_on
      target:
        device_id: bc73bb14e38e8396900015b6b0d86506
  mode: single
- id: "17016780383725624"
  alias: TV Ambient lights OFF when TV off
  trigger:
    - platform: state
      entity_id:
        - remote.den_tv
      to: "off"
  action:
    - service: homeassistant.turn_off
      target:
        device_id: bc73bb14e38e8396900015b6b0d86506
  mode: single
- id: "17016473051966192"
  alias: Doorbell
  trigger:
    - platform: device
      device_id: 011d22447a45c26939459e4d099889cb
      domain: nest
      type: camera_person
  action:
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: Person Detected at Front door
        title: Someone is at Front door
        data:
          image: /api/nest/event_media/{{ trigger.event.data.device_id }}/{{ trigger.event.data.nest_event_id }}/thumbnail
    - service: notify.android_tv_fire_tv
      data:
        message: Person Detected at Front door
        title: Someone is at Front door
- id: "17016817804741351"
  alias: Foyer Lights ON
  trigger:
    - platform: state
      entity_id:
        - light.foyer_lights
      to: "on"
  action:
    - service: light.turn_on
      target:
        entity_id: light.foyer_accent_lights
  mode: single
- id: "17016821780511872"
  alias: Foyer Lights OFF
  trigger:
    - platform: state
      entity_id:
        - light.ha2_foyer_light
      to: "off"
  action:
    - service: light.turn_off
      target:
        entity_id: light.foyer_accent_lights
  mode: single
- id: "17016482488751674"
  alias: Theme change for Island video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: island
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17016852488856489"
  alias: Theme change for waves video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: waves
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17019682488958358"
  alias: Theme change for space video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: space
  action:
    - service: script.browser_theme_blue
  mode: single
- id: "17016824889058894"
  alias: Theme change for nightClouds video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: nightClouds
  action:
    - service: script.browser_theme_ocean
  mode: single
- id: "17016842489168384"
  alias: Theme change for greenNeon video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: greenNeon
  action:
    - service: script.browser_theme_lime
  mode: single
- id: "17016282489302842"
  alias: Theme change for moonRising video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: moonRising
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17016824849385397"
  alias: Theme change for berry video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: berry
  action:
    - service: script.browser_theme_purple
  mode: single
- id: "17011682489641350"
  alias: Theme change for orangeSunset video
  description: Theme change for orangeSunset video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: orangeSunset
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17016582489708685"
  alias: Theme change for inferno video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: inferno
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17016682490776105"
  alias: Theme change for fireworks video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: fireworks
  action:
    - service: script.browser_theme_red
  mode: single
- id: "17016282491409399"
  alias: Theme change for fullMoon video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: fullMoon
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17016827494516919"
  alias: Theme change for Fire video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: fire
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17016825351619303"
  alias: Theme change for darkskyMoon video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: darkskyMoon
  action:
    - service: script.browser_theme_magenta
  mode: single
- id: "17016282536189205"
  alias: Theme change for spookyMoon video
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: spookyMoon
  action:
    - service: script.browser_theme_grey
  mode: single
- id: "17017683173367800"
  alias: Theme change for beachyWaves
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: beachyWaves
  action:
    - service: script.browser_theme_orange
  mode: single
- id: "17016883173615818"
  alias: Theme change for cloudyMoon
  trigger:
    - platform: state
      entity_id:
        - input_select.video_wallpaper
      to: cloudyMoon
  action:
    - service: script.browser_theme_blue
  mode: single
- id: "17016913772131149"
  alias: Guest door closed
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.guest_door
      to: "off"
  action:
    - service: fan.turn_off
      target:
        entity_id: fan.ha2_guest_ceiling_fan
    - service: light.turn_off
      target:
        entity_id: light.guest_ceiling_lights
  mode: single
- id: "17016936409052665"
  alias: Download NOAA latest.jpg
  description: Downloads the lastest.jpg from NOAA.org
  trigger:
    - platform: time_pattern
      minutes: /5
      enabled: true
  condition:
    - condition: state
      entity_id: input_boolean.radar_updates
      state: "on"
  action:
    - service: downloader.download_file
      data:
        overwrite: true
        url: https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/gm/Sandwich/latest.jpg
        filename: lastest.jpg
  mode: single
- id: "1711693409272716"
  alias: Updates NOAA animated.gif
  description: Updates the animated.gif from NOAA.org
  trigger:
    - platform: time_pattern
      minutes: /15
      enabled: true
  condition:
    - condition: state
      entity_id: input_boolean.radar_updates
      state: "on"
  action:
    - service: downloader.download_file
      data:
        overwrite: true
        url: https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/smv/13/GOES16-SMV-13-600x600.gif
        filename: animated.gif
  mode: single
- id: "1721694580028233"
  alias: Northern Aurora
  description: Downloads the lastest northern aurora.jpg from NOAA.org
  trigger:
    - platform: time_pattern
      minutes: /5
      enabled: true
  condition:
    - condition: state
      entity_id: input_boolean.radar_updates
      state: "on"
  action:
    - service: downloader.download_file
      data:
        overwrite: true
        url: https://services.swpc.noaa.gov/images/animations/ovation/north/latest.jpg
        filename: northern_aurora.jpg
  mode: single
- id: "1731694580133307"
  alias: Southern Aurora
  description: Downloads the lastest southern aurora.jpg from NOAA.org
  trigger:
    - platform: time_pattern
      minutes: /5
      enabled: true
  condition:
    - condition: state
      entity_id: input_boolean.radar_updates
      state: "on"
  action:
    - service: downloader.download_file
      data:
        overwrite: true
        url: https://services.swpc.noaa.gov/images/animations/ovation/south/latest.jpg
        filename: southern_aurora.jpg
  mode: single
- id: "1741695422320496"
  alias: Reset Home Screen
  description: Reset Home Screen on Mobile every 15 mins
  trigger:
    - platform: time_pattern
      minutes: /15
      enabled: true
  action:
    - service: input_select.select_option
      data:
        option: mobile3
      target:
        entity_id: input_select.mobilelayout
  mode: single
- id: "17081207628341"
  alias: Bathroom motion low battery
  trigger:
    - type: battery_level
      platform: device
      device_id: 1f1dda5c9dba4825c89a35eddc9ac5dc
      entity_id: aea3e136eb73087cf415d3ec530bbfad
      domain: sensor
      below: 35
  action:
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: Bathroom motion battery is below 35%
        title: BATTERY LOW
  mode: single
- id: "17091227643669"
  alias: "[AUTO] Bathroom vent when door opened"
  trigger:
    - type: opened
      platform: device
      device_id: ddfdaa597a6f3d5253692718365c95a1
      entity_id: 7d7ea576c802654a8876e7ae82d10add
      domain: binary_sensor
  action:
    - service: switch.turn_on
      target:
        entity_id: switch.bathroom_vent
    - delay:
        minutes: 3
    - service: switch.turn_off
      target:
        entity_id: switch.bathroom_vent
  mode: restart
- id: "170112684169772"
  alias: Sports sensor update
  trigger:
    - platform: time_pattern
      seconds: "30"
  condition:
    - condition: state
      entity_id: input_boolean.sports_updates
      state: "on"
  action:
    - service: homeassistant.update_entity
      target:
        entity_id:
          - sensor.predators
          - sensor.atlanta_braves
          - sensor.saints
          - sensor.titans
  mode: single
- id: "170122912923254"
  alias: "[SWITCH] Kitchen 3-way"
  trigger:
    - platform: device
      type: changed_states
      device_id: 54688f4240e56b2dad3b68eb833fb7d2
      entity_id: b85ce05c4935bcbb66b16fce460e2237
      domain: light
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - service: homeassistant.turn_{{- trigger.to_state.state -}}
      data:
        entity_id: light.kitchen_ceiling_lights
  mode: single
- id: "170132997235605"
  alias: Kitchen 2 motion pic
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.kitchen_bt_motion_2
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
      enabled: true
  action:
    - service: button.press
      target:
        entity_id: button.wyze_cam_kitchen_cam_2_update_snapshot
    - delay:
        seconds: 4
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: Kitchen Motion at {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_kitchen_cam_2_snapshot?token={{ state_attr('camera.wyze_cam_kitchen_cam_2_snapshot','access_token')
            }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
  mode: single
- id: "170143000782411"
  alias: Kitchen 1 motion pic
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.kitchen_bt_motion
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
      enabled: true
  action:
    - service: button.press
      target:
        entity_id: button.wyze_cam_kitchen_cam_update_snapshot
    - delay:
        seconds: 8
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: Kitchen Motion at {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_kitchen_cam_snapshot?token={{ state_attr('camera.wyze_cam_kitchen_cam_snapshot','access_token')
            }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
  mode: single
- id: "170153002392645"
  alias: Front Door Last motion pic
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.front_motion
      to: "on"
    - platform: device
      device_id: 011d22447a45c26939459e4d099889cb
      domain: nest
      type: camera_person
  condition:
    - condition: state
      entity_id: input_boolean.camera_snapshots
      state: "on"
  action:
    - service: button.press
      target:
        entity_id: button.wyze_cam_front_door_cam_update_snapshot
    - service: button.press
      target:
        entity_id: button.wyze_cam_front_yard_cam_update_snapshot
    - choose:
        - conditions:
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - service: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.office_google
                volume_level: "0.50"
            - service: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.office_google
                message: Motion at front door
        - conditions:
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
          sequence:
            - service: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.80"
            - service: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion at front door
    - delay:
        seconds: 4
    - service: notify.notify_all
      data:
        message: âš ï¸Porch Motion!âš ï¸ï¸ {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_front_door_cam_snapshot?token={{
            state_attr('camera.wyze_cam_front_door_cam_snapshot','access_token') }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
    - delay:
        seconds: 4
    - service: notify.notify_all
      data:
        message: âš ï¸Front Motion!âš ï¸ï¸ {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_front_yard_cam_snapshot?token={{
            state_attr('camera.wyze_cam_front_yard_cam_snapshot','access_token') }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
    - delay: 300
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.40"
    - delay: 2
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.office_google
        volume_level: "0.40"
  mode: single
  max_exceeded: silent
- id: "170163035746544"
  alias: Notify of Camera channel importance
  trigger: []
  action:
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: Motion Detected
        data:
          channel: Cameras
          ledColor: red
- id: "170173036339632"
  alias: Side Door Last motion pic
  description: ""
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.driveway_motion
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.camera_snapshots
      state: "on"
  action:
    - service: button.press
      target:
        entity_id: button.wyze_cam_drive_side_camera_update_snapshot
    - choose:
        - conditions:
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - service: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.office_google
                volume_level: "0.50"
            - service: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.office_google
                message: Motion at side door
        - conditions:
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
          sequence:
            - service: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.80"
            - service: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion at side door
    - delay:
        seconds: 4
    - service: notify.notify_all
      data:
        message: âš ï¸Side Door Motion!âš ï¸ï¸{{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_drive_side_camera_snapshot?token={{
            state_attr('camera.wyze_cam_drive_side_camera_snapshot','access_token')
            }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
    - delay: 300
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.40"
    - delay: 2
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.office_google
        volume_level: "0.40"
  mode: single
  max_exceeded: silent
- id: "170183046792101"
  alias: Back Door Last motion pic
  description: ""
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.back_motion
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.camera_snapshots
      state: "on"
  action:
    - service: button.press
      target:
        entity_id: button.wyze_cam_patio_camera_update_snapshot
    - choose:
        - conditions:
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - service: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.office_google
                volume_level: "0.50"
            - service: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.office_google
                message: Motion on patio
        - conditions:
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
          sequence:
            - service: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.80"
            - service: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion on patio
    - delay:
        seconds: 4
    - service: notify.notify_all
      data:
        message: âš ï¸Patio Motion!âš ï¸ï¸{{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_patio_camera_snapshot?token={{ state_attr('camera.wyze_cam_patio_camera_snapshot','access_token')
            }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
    - delay: 300
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.40"
    - delay: 2
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.office_google
        volume_level: "0.40"
  mode: single
  max_exceeded: silent
- id: "170193047329426"
  alias: Garage Last motion pic
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.garage_motion_sensors
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.camera_snapshots
      state: "on"
  action:
    - service: button.press
      target:
        entity_id: button.wyze_cam_garage_camera_update_snapshot
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.80"
    - service: tts.google_say
      continue_on_error: true
      data:
        cache: true
        entity_id: media_player.tv_speakers
        message: Motion in the garage
    - delay:
        seconds: 4
    - service: notify.notify_all
      data:
        message: âš ï¸Garage Motion!âš ï¸ï¸ {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_garage_camera_snapshot?token={{ state_attr('camera.wyze_cam_garage_camera_snapshot','access_token')
            }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
    - delay: 300
    - service: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.40"
  mode: single
  max_exceeded: silent
- id: "170203097871969"
  alias: "[Motion] Side Motion Lights after Dark"
  trigger:
    - platform: state
      entity_id: binary_sensor.driveway_motion
      from: "off"
      to: "on"
  condition:
    - condition: or
      conditions:
        - condition: sun
          after: sunset
          after_offset: 45
        - condition: sun
          before: sunrise
          before_offset: 45
  action:
    - service: light.turn_on
      entity_id: light.front_yard_lights
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.driveway_motion
        from: "on"
        to: "off"
    - delay: 300
    - service: light.turn_off
      entity_id: light.front_yard_lights
  mode: restart
  max_exceeded: silent
- id: "170213097939844"
  alias: "[Motion] Patio Motion Lights after Dark"
  trigger:
    - platform: state
      entity_id: binary_sensor.back_motion
      from: "off"
      to: "on"
  condition:
    - condition: or
      conditions:
        - condition: sun
          after: sunset
          after_offset: 45
        - condition: sun
          before: sunrise
          before_offset: 45
  action:
    - service: light.turn_on
      entity_id: light.backyard_lights
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.back_motion
        from: "on"
        to: "off"
    - delay: 300
    - service: light.turn_off
      entity_id: light.backyard_lights
  mode: restart
  max_exceeded: silent
- id: "170223138270251"
  alias: "[Motion] Garage Motion Lights"
  trigger:
    - platform: state
      entity_id: binary_sensor.garage_motion_sensors
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "on"
  action:
    - service: light.turn_on
      entity_id: light.garage_ceiling_lights
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.garage_motion_sensors
        from: "on"
        to: "off"
    - delay: 900
    - service: light.turn_off
      entity_id: light.garage_ceiling_lights
  mode: restart
  max_exceeded: silent
- id: "170233166895065"
  alias: Darren's Alarm Pixel 8 pro next alarm
  trigger:
    - platform: template
      value_template:
        "{{ states('sensor.date_time') == (as_timestamp(states.sensor.pixel_8_pro_next_alarm.state)
        |int -300)| timestamp_custom('%Y-%m-%d, %H:%M', True) }} "
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
    - condition: state
      entity_id: input_boolean.darren_s_alarm_triggered_today
      state: "off"
    - condition: state
      entity_id: person.darren
      state: home
  action:
    - service: script.darrens_wake_up
  mode: single
- id: "1703172027074"
  alias: Donna's Alarm Pixel 5 next alarm
  trigger:
    - platform: template
      value_template:
        "{{ states('sensor.date_time') == (as_timestamp(states.sensor.pixel_5_next_alarm.state)
        |int -60)| timestamp_custom('%Y-%m-%d, %H:%M', True) }} "
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
    - condition: state
      entity_id: input_boolean.donna_s_alarm_triggered_today
      state: "off"
    - condition: state
      entity_id: person.donna
      state: home
  action:
    - service: script.donnas_wake_up
  mode: single
- id: "170243184400922"
  alias: "[Motion] Guest Motion Lights"
  trigger:
    - platform: state
      entity_id: binary_sensor.guest_motion
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "on"
    - condition: time
      after: 07:00:00
      before: "22:00:00"
  action:
    - service: light.turn_on
      entity_id: light.guest_ceiling_lights
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.guest_motion
        from: "on"
        to: "off"
    - delay: 300
    - service: light.turn_off
      entity_id: light.guest_ceiling_lights
  mode: restart
  max_exceeded: silent
- id: "17025318794468582"
  alias: "[Motion] Someone's at the Table"
  trigger:
    - type: motion
      platform: device
      device_id: 269bfe586d1a26f1b65fddeca53aa69e
      entity_id: 4e749991fa9d067cbd709f6239f0b863
      domain: binary_sensor
  condition: []
  action:
    - service: light.turn_on
      target:
        device_id: 760cfce120cdf3eedbaa7f35d36aa2db
    - wait_for_trigger:
        - platform: state
          entity_id:
            - binary_sensor.table_motion
          from: "on"
          to: "off"
    - delay:
        minutes: 15
    - service: light.turn_off
      target:
        device_id: 760cfce120cdf3eedbaa7f35d36aa2db
  mode: restart
  max_exceeded: silent
- id: "1703196844652"
  alias: "[Motion] Hall Bathroom Lights"
  trigger:
    - platform: state
      entity_id: binary_sensor.bathroom_motion
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "on"
  action:
    - choose:
        - conditions:
            - condition: time
              before: "22:29:59"
              after: 06:00:01
          sequence:
            - service: light.turn_on
              entity_id: light.bathroom_mirror
        - conditions:
            - condition: time
              before: 06:00:00
              after: "22:30:00"
          sequence:
            - service: light.turn_on
              entity_id: light.bathroom_ceiling_light
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.bathroom_motion
        from: "on"
        to: "off"
    - delay: 10
    - condition: state
      entity_id: binary_sensor.bathroom_door_bt
      state: "on"
      enabled: true
    - service: light.turn_off
      entity_id: light.bathroom_lights
  mode: restart
  max_exceeded: silent
- id: "170263206754260"
  alias: "[Motion] Bedroom Motion Lights"
  trigger:
    - platform: state
      entity_id: binary_sensor.bedroom_motion_sensors
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: binary_sensor.bedroom_door
      state: "on"
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "on"
  action:
    - choose:
        - conditions:
            - condition: time
              after: "09:30:00"
              before: "18:30:00"
              enabled: true
          sequence:
            - service: light.turn_on
              continue_on_error: true
              entity_id: light.mood_lights
            - service: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 45
              target:
                entity_id: light.nightstand_lights
            - service: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
        - conditions:
            - condition: time
              after: "18:30:01"
              before: "20:30:00"
              enabled: true
          sequence:
            - service: light.turn_on
              continue_on_error: true
              entity_id: light.mood_lights
            - service: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 15
              target:
                entity_id: light.nightstand_lights
            - service: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
        - conditions:
            - condition: time
              after: "20:30:01"
              before: "21:30:00"
              enabled: true
          sequence:
            - service: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 5
              target:
                entity_id: light.nightstand_lights
            - service: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
        - conditions:
            - condition: time
              after: "21:30:01"
              before: "22:30:00"
              enabled: true
          sequence:
            - service: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 5
              target:
                entity_id: light.donnas_light
            - service: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.bedroom_motion_sensors
        from: "on"
        to: "off"
    - delay: 600
    - service: light.turn_off
      entity_id: light.mood_lights
      continue_on_error: true
    - delay: 600
    - service: light.turn_off
      continue_on_error: true
      entity_id: light.darrens_light
    - delay: 900
    - service: light.turn_off
      continue_on_error: true
      entity_id: light.donnas_light
    - service: switch.turn_off
      continue_on_error: true
      entity_id: switch.ensuite_kiosk_screen
  mode: restart
  max_exceeded: silent
- id: "1703032245565054"
  alias: "[Motion] Office night light"
  trigger:
    - type: motion
      platform: device
      device_id: 5ba129f5afddad4746612d2d8d985871
      entity_id: 11d607ec53cc97b3fe7069a87115296f
      domain: binary_sensor
  condition: []
  action:
    - service: light.turn_on
      target:
        device_id: 5ba129f5afddad4746612d2d8d985871
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.office_night_motion
        from: "on"
        to: "off"
    - delay: 10
      enabled: true
    - service: light.turn_off
      target:
        device_id: 5ba129f5afddad4746612d2d8d985871
  mode: restart
  max_exceeded: silent
- id: "170273218670383"
  alias: Front Door TTS
  trigger:
    - platform: state
      entity_id: binary_sensor.front_door
      to: "on"
    - platform: state
      entity_id: binary_sensor.front_door
      to: "off"
  condition:
    - condition: state
      entity_id: input_boolean.door_announcements
      state: "on"
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - service: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          {% if is_state("binary_sensor.front_door", "on") %}
            Front door opened
          {% elif is_state("binary_sensor.front_door", "off") %}
            Front door closed
          {% else %} {% endif %}
    - service: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.front_door", "on") %}
            âš ï¸Front DoorðŸšªopened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.front_door", "off") %}
            âš ï¸Front DoorðŸšªclosed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued
- id: "170283218843560"
  alias: Back Door TTS
  trigger:
    - platform: state
      entity_id: binary_sensor.back_door
      to: "on"
    - platform: state
      entity_id: binary_sensor.back_door
      to: "off"
  condition:
    - condition: state
      entity_id: input_boolean.door_announcements
      state: "on"
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - service: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          {% if is_state("binary_sensor.back_door", "on") %}
            Back door opened
          {% elif is_state("binary_sensor.back_door", "off") %}
            Back door closed
          {% else %} {% endif %}
    - service: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.back_door", "on") %}
            âš ï¸Back DoorðŸšªopened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.back_door", "off") %}
            âš ï¸Back DoorðŸšªclosed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued
- id: "170293219333914"
  alias: Side Door TTS
  trigger:
    - platform: state
      entity_id: binary_sensor.side_door
      to: "on"
    - platform: state
      entity_id: binary_sensor.side_door
      to: "off"
  condition:
    - condition: state
      entity_id: input_boolean.door_announcements
      state: "on"
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - service: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          {% if is_state("binary_sensor.side_door", "on") %}
            Side door opened
          {% elif is_state("binary_sensor.side_door", "off") %}
            Side door closed
          {% else %} {% endif %}
    - service: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.side_door", "on") %}
            âš ï¸Side DoorðŸšªopened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.side_door", "off") %}
            âš ï¸Side DoorðŸšªclosed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued

#- id: "170313224579395"
#  alias: Pixel sleep tracking stop

- id: "170323250576301"
  alias: Garage Door TTS
  trigger:
    - platform: state
      entity_id: binary_sensor.garage_door_sensor_zb
      to: "on"
    - platform: state
      entity_id: binary_sensor.garage_door_sensor_zb
      to: "off"
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - service: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          '{% if is_state("binary_sensor.garage_door_sensor_zb", "on") %}
            Garage door opened
          {% elif is_state("binary_sensor.garage_door_sensor_zb", "off") %}
            Garage door closed
          {% else %} {% endif %}'
    - service: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.garage_door_sensor_zb", "on") %}
            âš ï¸Garage Doorâš ï¸opened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.garage_door_sensor_zb", "off") %}
            âš ï¸Garage Doorâš ï¸closed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued

- id: "170343250676301455712"
  alias: "Donna is awake"
  mode: single
  trigger:
    - platform: state
      entity_id:
        - light.bedroom_lights
      to: "on"
      for:
        seconds: 30
    - platform: state
      entity_id:
        - binary_sensor.bedroom_motion_sensors
      to: "on"
  condition:
    - condition: time
      before: "11:00:00"
      after: "05:00:00"
  action:
    - wait_for_trigger:
        platform: state
        entity_id: binary_sensor.bedroom_door
        to: "on"
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.donna_is_awake
- id: "17034325444301455712"
  alias: "Darren is awake"
  mode: single
  trigger:
    - platform: state
      entity_id:
        - light.office_lights
      to: "on"
      for:
        minutes: 3
  condition:
    - condition: time
      before: "11:00:00"
      after: "04:00:00"
  action:
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.darren_is_awake
    - service: notify.mobile_app_pixel_8_pro
      data:
        message: command_broadcast_intent
        data:
          intent_package_name: com.urbandroid.sleep
          intent_action: com.urbandroid.sleep.alarmclock.STOP_SLEEP_TRACK
          ttl: 0
          priority: high
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.door_announcements
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.radar_updates
- id: "1703432544430144455712"
  alias: "Everyone is awake"
  mode: single
  trigger:
    - platform: state
      entity_id:
        - binary_sensor.everyone_awake
      to: "on"
  action:
    - service: input_boolean.turn_on
      target:
        entity_id: input_boolean.everyone_is_awake
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.door_announcements
    - delay:
        hours: 1
    - service: media_player.volume_set
      target:
        entity_id: media_player.living_room_google
      data:
        volume_level: 0.55
- id: "17033325057263014567"
  alias: Guest room auto fan
  trigger:
    - platform: numeric_state
      entity_id: sensor.guest_room_temperature
      above: 76
    - platform: numeric_state
      entity_id: sensor.guest_room_temperature
      below: 75
  action:
    service_template: >
      {% if states('sensor.guest_room_temperature')|float > 76 %}
        switch.turn_on
      {% elif states('sensor.guest_room_temperature')|float < 75 %}
        switch.turn_off
      {% endif %}
    entity_id: fan.ha2_guest_ceiling_fan
- id: "17033325058863014567"
  alias: Office auto fan
  trigger:
    - platform: numeric_state
      entity_id: sensor.office_temperature_2
      above: 76
    - platform: numeric_state
      entity_id: sensor.office_temperature_2
      below: 75
  action:
    service_template: >
      {% if states('sensor.office_temperature_2')|float > 76 %}
        switch.turn_on
      {% elif states('sensor.office_temperature_2')|float < 75 %}
        switch.turn_off
      {% endif %}
    entity_id: fan.office_fan
- id: "17033399058863014567"
  alias: Den auto fan
  trigger:
    - platform: numeric_state
      entity_id: sensor.den_temperature
      above: 76
    - platform: numeric_state
      entity_id: sensor.den_temperature
      below: 75
  action:
    service_template: >
      {% if states('sensor.den_temperature')|float > 76 %}
        switch.turn_on
      {% elif states('sensor.den_temperature')|float < 75 %}
        switch.turn_off
      {% endif %}
    entity_id: fan.den_ceiling_fan
- id: "17033673058863014567"
  alias: Bedroom auto fan
  trigger:
    - platform: numeric_state
      entity_id: sensor.bedroom_temperature_2
      above: 75
    - platform: numeric_state
      entity_id: sensor.bedroom_temperature_2
      below: 74
  action:
    service_template: >
      {% if states('sensor.bedroom_temperature_2')|float > 75 %}
        switch.turn_on
      {% elif states('sensor.bedroom_temperature_2')|float < 74 %}
        switch.turn_off
      {% endif %}
    entity_id: fan.bedroom_fan
- id: "170883399227153856993332311"
  alias: Romance Time
  description: ""
  mode: single
  trigger:
    - platform: state
      entity_id:
        - input_boolean.romance_time
      to: "on"
    - platform: state
      entity_id:
        - input_boolean.romance_time_2
      to: "on"
  action:
    - service: light.turn_off
      target:
        entity_id: light.bedroom_lights
    - service: light.turn_on
      target:
        entity_id: light.nightstand_lights
      data:
        color_name: red
        brightness_pct: 4
    - service: media_player.play_media
      target:
        entity_id: media_player.bedroom_speaker
      data:
        media_content_id: >-
          spotify://9f616d8fea216b2657003da0fa09fb2d/spotify:playlist:5zi91HUGYmLXm6EaKaycIr
        media_content_type: spotify://playlist
      metadata:
        title: Lovely Nights
        thumbnail: https://i.scdn.co/image/ab67616d0000b273521970c52fd7470e5c515c1a
        media_class: playlist
        children_media_class: track
        navigateIds:
          - {}
          - media_content_type: spotify://library
            media_content_id: spotify://9f616d8fea216b2657003da0fa09fb2d
          - media_content_type: spotify://current_user_playlists
            media_content_id: spotify://9f616d8fea216b2657003da0fa09fb2d/current_user_playlists
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.romance_time
    - service: input_boolean.turn_off
      target:
        entity_id: input_boolean.romance_time_2
