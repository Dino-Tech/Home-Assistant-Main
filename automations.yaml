- id: "1701111117565"
  alias: Report state on start-up
  triggers:
    - trigger: homeassistant
      event: start
  action:
    - action: mqtt.publish
      data:
        topic: shellies/command
        payload: announce
    - delay:
        seconds: 5
    - action: button.press
      continue_on_error: true
      target:
        entity_id: button.main_kiosk_load_start_url
    - action: button.press
      continue_on_error: true
      target:
        entity_id: button.ensuite_kiosk_load_start_url
    - delay:
        seconds: 5
    - action: frontend.set_theme
      data:
        name: Blue-Nightz
  mode: single
  initial_state: true
- id: "1735793299155456532216"
  alias: Integration Watchdog ## code framework thanks to @dsellers1
  description: >
    This automation watches entities to ensure the integration is functioning; if
    not, it will restart it.
  triggers:
    - trigger: state
      entity_id:
        - camera.backyard
        - camera.driveway
        - camera.entryway
        - camera.garage_cam_wuuk
        - camera.front_door
        - camera.front_yard_cam
        - camera.kitchen
        - camera.den
        - camera.patio
        - camera.porch
        - camera.rambo_cam
      to: unavailable
      for:
        minutes: 2
  action:
    - action: homeassistant.reload_config_entry
      target:
        entity_id: "{{ trigger.entity_id }}"
  mode: single
  initial_state: true
- id: "17055772299155456532"
  mode: single
  alias: Start Voice assistant initiated Timer When Duration Set and notify when completed
  triggers:
    - trigger: numeric_state
      entity_id:
        - input_number.timer_minutes
        - input_number.timer_seconds
      above: 0
  action:
    - delay: 1
    - action: timer.set_duration
      target:
        entity_id: timer.voice_timer
      data_template:
        duration: >-
          00:{{ states('input_number.timer_minutes') | int }}:{{ states('input_number.timer_seconds') | int }}
    - delay: 1
    - action: timer.start
      entity_id: timer.voice_timer
    - wait_for_trigger:
        trigger: state
        entity_id: timer.voice_timer
        from: active
        to: idle
    - action: notify.mobile_app_pixel_8_pro
      data_template:
        title: Timer Finished
        message: >-
          {{ state_attr('timer.voice_timer', 'duration') }} timer has finished
    - delay: 1
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: The timer has finished
    - action: input_number.set_value
      data:
        value: 0
      target:
        entity_id:
          - input_number.timer_seconds
          - input_number.timer_minutes
- id: "1705577229915545231"
  alias: Turn on lights when garage or side door opened after dark
  mode: restart
  triggers:
    - trigger: state
      entity_id:
        - cover.garage_door
      to: open
    - trigger: state
      entity_id:
        - binary_sensor.side_door_bt
      to: "on"
  condition:
    - condition: or
      conditions:
        - condition: sun
          after: sunset
          after_offset: 15
        - condition: sun
          before: sunrise
          before_offset: 15
  action:
    - action: light.turn_on
      target:
        entity_id: light.front_yard_lights
    - delay: 600
    - action: light.turn_off
      target:
        entity_id: light.front_yard_lights
- id: "18011577229915545231"
  alias: "turn ON backyard lights when door opened"
  mode: restart
  triggers:
    - trigger: state
      entity_id: binary_sensor.back_door1, binary_sensor.backdoor_bt_sensor
      to: "on"
    - trigger: state
      entity_id: binary_sensor.back_motion
      to: "on"
  condition:
    - condition: or
      conditions:
        - condition: sun
          after: sunset
          after_offset: 15
        - condition: sun
          before: sunrise
          before_offset: 15
  action:
    - action: light.turn_on
      target:
        entity_id: light.backyard_lights
    - delay: 600
    - action: light.turn_off
      target:
        entity_id: light.patio_fan_light, light.back_floodlights2
- id: "1783625788126933756"
  alias: Outside Cam Notifications ON when dark
  mode: single
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.night
      to: "on"
      for:
        minutes: 30
  action:
    - action: switch.turn_on
      target:
        entity_id: switch.outside_cam_notifications
- id: "1705577229915545"
  alias: Reload kiosk when lovelace is updated ## code framework thanks to @dsellers1
  triggers:
    - trigger: event
      event_type: lovelace_updated
  condition:
    - condition: state
      entity_id: input_boolean.kiosk_auto_refresh
      state: "on"
  action:
    - action: lovelace.reload_resources
    - delay: 6
    - choose:
        - conditions:
            - condition: state
              entity_id: switch.main_kiosk_screen
              state: "off"
          sequence:
            - action: switch.turn_on
              entity_id: switch.main_kiosk_screen
            - delay: 2
            - action: button.press
              target:
                entity_id: button.main_kiosk_load_start_url
        - conditions:
            - condition: state
              entity_id: switch.main_kiosk_screen
              state: "on"
          sequence:
            - delay: 2
            - action: button.press
              target:
                entity_id: button.main_kiosk_load_start_url
    - choose:
        - conditions:
            - condition: state
              entity_id: switch.ensuite_kiosk_screen
              state: "off"
          sequence:
            - action: switch.turn_on
              entity_id: switch.ensuite_kiosk_screen
            - delay: 2
            - action: button.press
              target:
                entity_id: button.ensuite_kiosk_load_start_url
        - conditions:
            - condition: state
              entity_id: switch.ensuite_kiosk_screen
              state: "on"
          sequence:
            - delay: 2
            - action: button.press
              target:
                entity_id: button.ensuite_kiosk_load_start_url
  mode: single
- id: "17016739887151444"
  alias: Reboot Kiosk
  triggers:
    - trigger: device
      type: turned_off
      device_id: 17f117e87ed2ea44630be8afa72f7334
      entity_id: switch.main_kiosk_screen
      domain: switch
    - trigger: state
      entity_id:
        - light.ac9b7f58_cfbfe785_screen
      to: "off"
  condition:
    - condition: time
      after: 05:00:00
      before: "23:59:01"
  action:
    - delay:
        minutes: 1
    - action: switch.turn_on
      target:
        entity_id: switch.main_kiosk_screen
    - delay: 3
    - action: light.turn_on
      target:
        entity_id: light.ac9b7f58_cfbfe785_screen
    - delay: 3
    - action: button.press
      target:
        entity_id: button.main_kiosk_load_start_url
  mode: single
- id: "17055555555545"
  alias: Create a notification when something is added to HACS
  initial_state: true
  trigger:
    - trigger: event
      event_type: hacs/repository
      event_data:
        action: registration
  condition:
    condition: template
    value_template: "{{ trigger.event.data.repository is defined }}"
  action:
    action: persistent_notification.create
    data_template:
      title: New repository in HACS
      message:
        "{% set repo = trigger.event.data.repository %} {% set id = trigger.event.data.repository_id
        %} [{{ repo }}](/hacs/repository/{{ id }}) was just added to HACS."
- id: "17066666666675"
  alias: Cuckoo Clock
  triggers:
    - trigger: time_pattern
      hours: "*"
      minutes: "0"
    - trigger: time_pattern
      minutes: "30"
  condition:
    - condition: state
      entity_id: input_boolean.cuckoo_clock
      state: "on"
    - condition: time
      after: 09:29:00
      before: "21:30:00"
    - condition: template
      value_template: |
        {% if is_state('light.tv_ambient_lights', 'on') %}
          false
        {% else %}
          true
        {% endif %}
  action:
    - action: media_player.play_media
      data_template:
        entity_id: media_player.ac9b7f58_cfbfe785
        media_content_id: >-
          {% if now().strftime("%M")|int == 30 %}
          media-source://media_source/local/cuckoo-clock-01.wav {% else %}
          media-source://media_source/local/cuckoo-clock-{{now().strftime("%I")}}.wav
          {% endif %}
        media_content_type: music
  initial_state: true
- id: "170666736526675"
  alias: Grandfather Clock
  triggers:
    - trigger: time_pattern
      hours: "*"
      minutes: "0"
    - trigger: time_pattern
      minutes: "30"
  condition:
    - condition: state
      entity_id: input_boolean.grandfather_clock
      state: "on"
    - condition: time
      after: 09:29:00
      before: "21:30:00"
    - condition: state
      entity_id: remote.den_tv
      state: "off"
    - condition: template
      value_template: |
        {% if is_state('light.tv_ambient_lights', 'on') %}
          false
        {% else %}
          true
        {% endif %}
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: media_player.tv_speakers
              state: "off"
          sequence:
            - action: media_player.volume_set
              data:
                volume_level: 0
              target:
                entity_id: media_player.tv_speakers
            - action: media_player.turn_on
              target:
                entity_id: media_player.tv_speakers
            - wait_template: "{{ is_state('media_player.tv_speakers', 'idle') }}"
            - action: media_player.volume_set
              data:
                volume_level: 0.4
              target:
                entity_id: media_player.tv_speakers
        - conditions:
            - condition: state
              entity_id: media_player.tv_speakers
              state: idle
          sequence:
            - action: media_player.volume_set
              data:
                volume_level: 0.4
              target:
                entity_id: media_player.tv_speakers
            - delay: 1
    - action: media_player.play_media
      data_template:
        entity_id: media_player.tv_speakers
        media_content_id: >-
          {% if now().strftime("%M")|int == 15 %}
          media-source://media_source/local/gf-hour-15.mp3
          {% elif now().strftime("%M")|int == 30 %}
          media-source://media_source/local/gf-hour-30.mp3
          {% elif now().strftime("%M")|int == 45 %}
          media-source://media_source/local/gf-hour-45.mp3 {% else %}
          media-source://media_source/local/gf-hour-{{now().strftime("%I")}}.mp3
          {% endif %}
        media_content_type: music
  initial_state: true
- id: "170999999999458"
  alias: "[Notify] Smoke Detected"
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.nest_protect_hallway_smoke_status
        - binary_sensor.nest_protect_kitchen_smoke_status
        - binary_sensor.nest_protect_garage_smoke_status
        - binary_sensor.laundry_smoke_detected
      to: "on"
      for:
        seconds: 5
  action:
    - action: noonlight.create_alarm
      data:
        action: fire
    - action: climate.turn_off
      target:
        entity_id: climate.den
    - action: switch.turn_off
      entity_id:
        - switch.dryer_plug
    - action: light.turn_on
      target:
        entity_id: light.every_light
    - action: notify.notify_all
      data_template:
        message: "{{ trigger.to_state.attributes.friendly_name }} smoke detected 🔥 "
        title: Smoke Alarm
        data:
          channel: alert
          group: alert
          sticky: true
          importance: high
          notification_icon: "mdi:smoke-detector-variant-alert"
  initial_state: true
- id: "1773719935299957"
  alias: "[Notify] HVAC Water Leak"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: binary_sensor.hvac_leak_sensor
      to: "on"
  action:
    - action: notify.mobile_app_pixel_8_pro
      continue_on_error: true
      data:
        message: TTS
        data:
          tts_text: Air conditioner is leaking!!!
          media_stream: "alarm_stream_max"
    - action: notify.mobile_app_pixel_5
      continue_on_error: true
      data:
        message: TTS
        data:
          tts_text: Air conditioner is leaking!!!
          media_stream: "alarm_stream_max"
    - action: notify.notify_all
      continue_on_error: true
      data:
        message: Air conditioner leaking {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: "mdi:water"
          visibility: public
    - action: climate.turn_off
      continue_on_error: true
    - action: script.hvac_water_leak
- id: "17019999999957"
  alias: "[Notify] Water Heater Leak"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: binary_sensor.water_heater_leak_sensor
      to: "on"
  action:
    - action: notify.mobile_app_pixel_8_pro
      continue_on_error: true
      data:
        message: TTS
        data:
          tts_text: Water heater is leaking!!!
          media_stream: "alarm_stream_max"
    - action: notify.mobile_app_pixel_5
      continue_on_error: true
      data:
        message: TTS
        data:
          tts_text: Water heater is leaking!!!
          media_stream: "alarm_stream_max"
    - action: notify.notify_all
      continue_on_error: true
      data:
        message: Water heater leaking {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: "mdi:water"
          visibility: public
    - action: script.water_heater_leak
- id: "170299999999"
  alias: "[Notify] Washing Machine Leak"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: binary_sensor.washer_leak_sensor
      to: "on"
  action:
    - action: homeassistant.turn_off
      entity_id:
        - switch.washer_plug
    - action: script.washer_leak
- id: "1754999377123967"
  alias: "[Notify] Garage Fridge OFF"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: switch.kitchen_fridge
      to: "off"
      for:
        minutes: 2
  action:
    - action: notify.mobile_app_pixel_8_pro
      data_template:
        message: "Garage fridge turned off at '{{ now().strftime('%I:%M %p') }}' "
    - delay: 00:15:00
    - action: homeassistant.turn_on
      entity_id: switch.kitchen_fridge
    - action: notify.mobile_app_pixel_8_pro
      data_template:
        message: "Garage fridge turned back on at '{{ now().strftime('%I:%M %p') }}' "
- id: "17069999999922"
  alias: "[Tablet] background morning"
  initial_state: true
  trigger:
    - trigger: time
      at: 04:30:00
  action:
    - action: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - christian41.1
          - coffee1_11
          - coffee1_21
          - wallpaper7e
          - coffee1_31
          - coffee1_41
          - coffee1_51
          - coffee1_61
          - coffee1_71
    - action:
        script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}
- id: "17079999999911"
  alias: "[Tablet] background midday"
  initial_state: true
  trigger:
    - trigger: time
      at: "10:00:00"
  action:
    - action: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - christian1.1
          - wallpaper13
          - wallpaper7e
          - wallpaper66
          - christian21
          - wallpaper141
          - wallpaper33
          - christian31
          - wallpaper21
          - christian41.1
          - christian5
          - christian61
          - christian7.1
    - action:
        script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}
- id: "17089999999955"
  alias: "[Tablet] background evening"
  initial_state: true
  trigger:
    - trigger: time
      at: "16:00:00"
  action:
    - action: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - wallpaper141
          - wallpaper1
          - wallpaper13
          - wallpaper7e
          - wallpaper66
          - eye11
          - christian21
          - wallpaper121
          - ufo1
          - christian5
          - welcome4
          - christian1.1
          - wallpaper5
    - action:
        'script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}'
- id: "17091999999944"
  alias: "[Tablet] background night"
  initial_state: true
  trigger:
    - trigger: time
      at: "19:00:00"
  action:
    - action: input_select.set_options
      entity_id: input_select.wallpaper
      data_template:
        options:
          - christian41.1
          - wallpaper13
          - moonFull
          - christian31
          - wallpaper7e
          - wallpaper141
          - moon2Blue
          - wallpaper66
          - wallpaper1
          - christian21
          - wallpaper21
          - moonLake
    - action:
        script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}
- id: "17092999999977"
  alias: "[Tablet] background select"
  initial_state: true
  trigger:
    - trigger: time_pattern
      minutes: /7
  action:
    - action: input_select.select_next
      entity_id: input_select.wallpaper
    - action:
        'script.{{["browser_theme_red", "browser_theme_orange", "browser_theme_yellow",
        "browser_theme_geaux", "browser_theme_magenta", "browser_theme_lime", "browser_theme_pink",
        "browser_theme_blue", "browser_theme_grey", "browser_theme_green", "browser_theme_purple",
        "browser_theme_ocean"] | random }}'
- id: "17093999999988"
  alias: "[Mobile] background select"
  initial_state: true
  trigger:
    - trigger: time_pattern
      minutes: /6
  action:
    - action: input_select.random # select_next
      entity_id:
        - input_select.mobile_wallpaper
        - input_select.video_wallpaper
- id: "17837532245565054"
  alias: "[Motion] ZB5 night lights and KIOSK"
  triggers:
    - trigger: state
      entity_id: binary_sensor.den_night_light_motion
      to: "on"
  action:
    - choose:
        - conditions:
            - condition: time
              after: "23:00:01"
              before: "05:30:00"
          sequence:
            - action: light.turn_on
              data_template:
                hs_color:
                  - "{{ range(360)|random }}"
                  - "{{ range(80,101)|random }}"
                brightness_pct: 40
              target:
                entity_id: light.den_night_lights_zb
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_motion_detected
              state: "on"
            - condition: time
              after: 05:30:01
              before: "23:00:00"
          sequence:
            - action: light.turn_on
              data_template:
                hs_color:
                  - "{{ range(360)|random }}"
                  - "{{ range(80,101)|random }}"
                brightness_pct: 100
              target:
                entity_id: light.den_night_lights_zb
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_motion_detected
              state: "off"
            - condition: time
              after: 05:30:01
              before: "23:00:00"
          sequence:
            - action: light.turn_on
              data_template:
                hs_color:
                  - "{{ range(360)|random }}"
                  - "{{ range(80,101)|random }}"
                brightness_pct: 100
              target:
                entity_id: light.den_night_lights_zb
            - action: switch.turn_on
              data:
                entity_id: switch.main_kiosk_screen
            - action: light.turn_on
              data:
                entity_id: light.ac9b7f58_cfbfe785_screen
            - action: browser_mod.navigate
              data:
                browser_id:
                  - ac9b7f58-cfbfe785
                path: /lovelace/newtab
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.den_night_light_motion
          from: "on"
          to: "off"
          for:
            seconds: 90
    #    - delay: 90
    - action: light.turn_off
      entity_id: light.den_night_lights_zb
    - choose:
        - conditions:
            - condition: time
              after: 05:30:01
              before: "23:00:00"
          sequence:
            - action: browser_mod.navigate
              data:
                browser_id:
                  - ac9b7f58-cfbfe785
                path: /lovelace/random
            - delay: 300
            - action: browser_mod.navigate
              data:
                path: /lovelace/screen
                browser_id:
                  - ac9b7f58-cfbfe785
        - conditions:
            - condition: time
              after: "22:30:01"
              before: 05:30:00
          sequence:
            - delay: 15
            - action: light.turn_off
              data:
                entity_id: light.ac9b7f58_cfbfe785_screen
  initial_state: true
  mode: restart
  max_exceeded: silent
- id: "17099299999977"
  alias: "[Tablet] Toggle tablet icons color"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: input_boolean.tablet_icons_color
  action:
    - action: homeassistant.turn_{{- trigger.to_state.state -}}
      data:
        entity_id: group.tablet_icons
- id: "17099939999933322"
  alias: "[Motion] Porch Motion Lights after Dark"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: binary_sensor.front_porch_motion
      from: "off"
      to: "on"
    - trigger: state
      entity_id: binary_sensor.front_door
      to: open
    - trigger: device
      device_id: 011d22447a45c26939459e4d099889cb
      domain: nest
      type: camera_person
  condition:
    - condition: or
      conditions:
        - condition: sun
          after: sunset
          after_offset: 45
        - condition: sun
          before: sunrise
          before_offset: 45
  action:
    - action: light.turn_on
      entity_id:
        - light.porch_light
        - light.front_yard_cam_floodlight
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.front_porch_motion
          from: "on"
          to: "off"
    - delay: 600
    - action: light.turn_off
      entity_id:
        - light.porch_light
        - light.front_yard_cam_floodlight
  mode: restart
  max_exceeded: silent
- id: "170999978999162"
  alias: "[Presence] Darren Away"
  triggers:
    - trigger: state
      entity_id:
        - person.darren
      to: not_home
      for:
        seconds: 30
  action:
    - action: input_boolean.turn_on
      entity_id:
        - input_boolean.camera_snapshots
        - input_boolean.patio_garage_alerts
    - action: homeassistant.turn_off
      continue_on_error: true
      entity_id:
        - input_boolean.darren_home
        - light.office_lights
        - switch.ha2_office_monitor
        - fan.hallway_fan
        - switch.ha2_work_bench
        - switch.keurig_coffee
  initial_state: true
  mode: single
- id: "170999979999163"
  alias: "[Presence] Darren Home"
  triggers:
    - trigger: state
      entity_id:
        - person.darren
      to: home
      for:
        seconds: 4
  action:
    - action: input_boolean.turn_off
      entity_id: input_boolean.patio_garage_alerts
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "on"
          sequence:
            - action: light.turn_on
              entity_id: light.outside_lights
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "off"
          sequence:
            - action: light.turn_on
              entity_id: light.entryway_dimmer
    - choose:
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: closed
          sequence:
            - action: cover.open_cover
              entity_id: cover.garage_door
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: open
          sequence:
            - action: light.turn_on
              data:
                entity_id: light.garage_ceiling_lights
    - action: homeassistant.turn_on
      continue_on_error: true
      entity_id:
        - input_boolean.darren_home
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.naptime
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.office_motion_sensors
          from: "off"
          to: "on"
    - action: homeassistant.turn_on
      continue_on_error: true
      entity_id:
        - fan.hallway_fan
        - switch.ha2_office_monitor
  initial_state: true
  mode: single
- id: "170999979999641209"
  alias: "[Presence] Donna Home"
  triggers:
    - trigger: state
      entity_id:
        - person.donna
      to: home
      for:
        seconds: 4
  action:
    - action: input_boolean.turn_off
      entity_id: input_boolean.patio_garage_alerts
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "on"
          sequence:
            - action: light.turn_on
              entity_id: light.outside_lights
        - conditions:
            - condition: state
              entity_id: binary_sensor.night
              state: "off"
          sequence:
            - action: light.turn_on
              entity_id: light.entryway_dimmer
    - choose:
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: closed
          sequence:
            - action: cover.open_cover # switch.turn_on
              entity_id: cover.garage_door # switch.garage_door
        - conditions:
            - condition: state
              entity_id: cover.garage_door
              state: open
          sequence:
            - action: light.turn_on
              data:
                entity_id: light.garage_ceiling_lights
    - action: input_boolean.turn_on
      entity_id: input_boolean.donna_home
  initial_state: true
  mode: single
- id: "170999989999524"
  alias: "[Presence] Donna Away"
  triggers:
    - trigger: state
      entity_id:
        - person.donna
      to: not_home
      for:
        seconds: 30
  action:
    - action: input_boolean.turn_off
      entity_id: input_boolean.donna_home
    - delay: 300
  mode: single
  initial_state: true
  max_exceeded: silent
- id: "170999993999165"
  alias: "[Presence] People Away"
  triggers:
    - trigger: state
      entity_id: group.person_group
      to: not_home
      for:
        seconds: 300
  action:
    - action: script.alarm_arm
    - action: script.people_away
    - action: switch.turn_off
      data:
        entity_id: switch.main_kiosk_screen
    - delay: 300
  mode: single
  max_exceeded: silent
- id: "170999994999166"
  alias: "[Presence] People Home"
  triggers:
    - trigger: state
      entity_id: group.person_group
      to: home
  action:
    - action: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.alarmo
      data:
        code: 3971
    - action: script.people_home
    - action: switch.turn_on
      continue_on_error: true
      data:
        entity_id: switch.main_kiosk_screen
    - action: light.turn_on
      continue_on_error: true
      data:
        entity_id: light.ac9b7f58_cfbfe785_screen
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/newtab
    - action: switch.turn_on
      continue_on_error: true
      data:
        entity_id: switch.ensuite_kiosk_screen
    - action: light.turn_on
      continue_on_error: true
      data:
        entity_id: light.ensuite_kiosk_screen
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /lovelace/ensuite_kiosk
    - choose:
        - conditions:
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - delay: 360
            - action: light.turn_off
              entity_id: light.outside_lights
        - conditions:
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
          sequence:
            - delay: 1200
            - action: light.turn_off
              entity_id: light.outside_lights
  mode: single
  max_exceeded: silent
- id: "170999995999164"
  alias: "[Timer] office fan off"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: fan.office_fan
      to: "on"
  action:
    - action: timer.start
      data:
        duration: >-
          {{ states.input_number.office_fan_duration.state | int(0) * 60 }}
      target:
        entity_id:
          - timer.office_fan_timer
    - wait_for_trigger:
        - trigger: state
          entity_id: timer.office_fan_timer
          from: active
          to: idle
    - action: fan.turn_off
      entity_id: fan.office_fan
- id: "302170975645999164"
  alias: "[Timer] 15 minute HVAC Fan timer"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: input_button.hvac_15_fan_timer
  action:
    - action: climate.set_fan_mode
      data:
        fan_mode: "on"
      target:
        entity_id: climate.den
    - delay:
        minutes: 15
    - action: climate.set_fan_mode
      data:
        fan_mode: "off"
      target:
        entity_id: climate.den
- id: "312170975645999164"
  alias: "[Timer] 30 minute HVAC Fan timer"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: input_button.hvac_30_fan_timer
  action:
    - action: climate.set_fan_mode
      data:
        fan_mode: "on"
      target:
        entity_id: climate.den
    - delay:
        minutes: 30
    - action: climate.set_fan_mode
      data:
        fan_mode: "off"
      target:
        entity_id: climate.den
- id: "17099999919856349"
  alias: "[Notify] Coffee Maker ON"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: switch.coffee_maker
      to: "on"
  action:
    - action: homeassistant.turn_on
      entity_id: light.coffee_light
    - action: notify.mobile_app_pixel_8_pro
      data_template:
        title: ⚠️Coffee☕️ Maker ON
        message: " at {{ states('sensor.time_12_hour_am_pm') }}"
- id: "170999999299876354"
  alias: "[TIMER] Fountain"
  triggers:
    - trigger: time
      at: "20:00:00"
  action:
    - action: switch.turn_on
      target:
        entity_id: switch.patio_fountain_plug
    - delay: 600
    - action: switch.turn_off
      target:
        entity_id: switch.patio_fountain_plug
  initial_state: true
- id: "170999999799168"
  alias: "[Motion] Kitchen Motion Lights"
  triggers:
    - trigger: state
      entity_id: binary_sensor.kitchen_motion_sensors
      from: "off"
      to: "on"
    - type: occupied
      device_id: 11ae90ced5ee1712eecfff81dc93849c
      entity_id: 4cee93a6bdbf5e7c5eadbf7db0533093
      domain: binary_sensor
      trigger: device
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - choose:
        - conditions:
            - condition: time
              after: "23:00:01"
              before: "05:30:00"
          sequence:
            - action: light.turn_on
              data:
                entity_id: light.cabinet_lights_3
        - conditions:
            - condition: time
              after: 05:30:01
              before: "23:00:00"
          sequence:
            - action: light.turn_on
              data:
                entity_id: light.cabinet_lights_3
            - action: light.turn_on
              data:
                entity_id: light.kitchen_ceiling_lights_3
    - wait_for_trigger:
        - type: not_occupied
          device_id: 11ae90ced5ee1712eecfff81dc93849c
          entity_id: 4cee93a6bdbf5e7c5eadbf7db0533093
          domain: binary_sensor
          trigger: device
    - action: light.turn_off
      entity_id: light.kitchen_ceiling_lights_3
    - action: light.turn_off
      entity_id: light.table_light
    - delay: 900
    - action: light.turn_off
      entity_id: light.cabinet_lights_3
  mode: restart
  max_exceeded: silent
  initial_state: true
- id: "1701618177497534"
  alias: "[Motion] Entryway Motion Lights"
  description: ""
  triggers:
    - trigger: state
      entity_id: binary_sensor.entryway_motion
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - action: light.turn_on
      entity_id: light.entryway_dimmer
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.entryway_motion
          from: "on"
          to: "off"
    - delay: 30
    - action: light.turn_off
      entity_id: light.entryway_dimmer, light.laundry_room_light
  mode: restart
  max_exceeded: silent
  initial_state: true
- id: "1771618178227534"
  alias: "[Motion] Laundry Motion Lights"
  description: ""
  triggers:
    - trigger: state
      entity_id: binary_sensor.laundry_motion_sensors
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - action: light.turn_on
      entity_id: light.laundry_room_light
  mode: restart
  max_exceeded: silent
- id: "179161817217497534"
  alias: "[Motion] Foyer Motion Lights"
  description: ""
  triggers:
    - trigger: state
      entity_id: binary_sensor.foyer_motion_sensors
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - action: light.turn_on
      entity_id: light.foyer_lights
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.foyer_motion_sensors
          from: "on"
          to: "off"
    - delay: 90
    - action: light.turn_off
      entity_id: light.foyer_lights
  mode: restart
  max_exceeded: silent
- id: "1706618177497534"
  alias: "[Auto] Hall Bath Vent auto off timer"
  triggers:
    - trigger: state
      entity_id: switch.bathroom_vent
      to: "on"
      for:
        minutes: 15
  action:
    - action: switch.turn_off
      entity_id: switch.bathroom_vent
  initial_state: true
  mode: single
- id: "17086148177497534"
  alias: "[Auto] Turn bathroom vent when humidity goes up"
  triggers:
    - trigger: numeric_state
      entity_id: sensor.bathroom_humidity_2
      above: 65
  action:
    - action: switch.turn_on
      target:
        entity_id: switch.bathroom_vent
    - delay: 300
  initial_state: true
  mode: single
  max_exceeded: silent
- id: "17837148177497534"
  alias: "[Auto] Turn bathroom vent when humidity goes down"
  triggers:
    - trigger: numeric_state
      entity_id: sensor.bathroom_humidity_2
      below: 59
  action:
    - action: switch.turn_off
      target:
        entity_id: switch.bathroom_vent
    - delay: 300
  initial_state: true
  mode: single
  max_exceeded: silent
- id: "17096181717497534"
  alias: "[Auto] Turn ensuite vent when humidity goes up"
  triggers:
    - trigger: numeric_state
      entity_id: sensor.ensuite_humidity_2
      above: 65
  condition:
    - condition: state
      entity_id: light.jacuzzi_light
      state: "off"
      enabled: true
  action:
    - action: switch.turn_on
      target:
        entity_id: fan.ensuite_vent_2
    - delay: 300
  initial_state: true
  mode: single
  max_exceeded: silent
- id: "17932481717497534"
  alias: "[Auto] Turn ensuite vent when humidity goes down"
  triggers:
    - trigger: numeric_state
      entity_id: sensor.ensuite_humidity_2
      below: 59
  condition:
    - condition: state
      entity_id: light.jacuzzi_light
      state: "off"
      enabled: true
  action:
    - action: switch.turn_off
      target:
        entity_id: fan.ensuite_vent_2
    - delay: 300
  initial_state: true
  mode: single
  max_exceeded: silent
- id: "17016381774975134"
  alias: "[Auto] Ensuite Vent auto off timer"
  triggers:
    - trigger: state
      entity_id: fan.ensuite_vent_2
      to: "on"
      for:
        minutes: 15
  action:
    - action: fan.turn_off
      entity_id: fan.ensuite_vent_2
  initial_state: true
  mode: single
- id: "17016185774975347"
  alias: "[Notify] Auto Notifications ON"
  triggers:
    - trigger: time
      at: "23:00:00"
  action:
    - action: input_boolean.turn_on
      entity_id:
        - input_boolean.camera_snapshots
        - input_boolean.patio_garage_alerts
        - input_boolean.door_announcements
        - input_boolean.disable_laundry_notifications
    - action: input_boolean.turn_off
      entity_id:
        - input_boolean.motion_lights
        - input_boolean.disable_popups
        - input_boolean.auto_tablet
        - input_boolean.auto_backgroundz
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: "⚠️️Notifications\U0001F4E2 turned ON"
  initial_state: true
  mode: single
- id: "17016518677497534"
  alias: Washer State - Start
  initial_state: true
  triggers:
    - trigger: numeric_state
      entity_id: sensor.washer_plug_energy_power
      above: 4
      for:
        minutes: 4
  condition:
    - condition: template
      value_template: "{{ states.sensor.washer_state.state != 'Washing' }}"
  action:
    - action: mqtt.publish
      data:
        topic: hass/state/washer
        payload: Washing
        retain: "true"
- id: "17016187747497534"
  alias: Washer State - Idle
  initial_state: true
  triggers:
    - trigger: numeric_state
      entity_id: sensor.washer_plug_energy_power
      below: 5
      for:
        minutes: 4
  action:
    - action: mqtt.publish
      data:
        topic: hass/state/washer
        payload: Idle
        retain: "true"
- id: "17016188774927534"
  alias: "Washing finished"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: sensor.washer_state
      from: Washing
      to: Idle
  condition:
    - condition: state
      entity_id: input_boolean.disable_laundry_notifications
      state: "off"
  action:
    - action: media_player.volume_set
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.50"
    - action: tts.google_say
      entity_id: media_player.tv_speakers
      data_template:
        message: Donna or Darren..,,Clothes ready..,The washing machine has finished!
    - action: notify.pixels_and_den_tv
      data_template:
        message: "Washing👕👗👖Finished {{ states('sensor.time_12_hour_am_pm') }}"
- id: "17016189747497534"
  alias: Dryer State - Drying
  initial_state: true
  triggers:
    - trigger: numeric_state
      entity_id: sensor.dryer_energy_power
      above: 50
      for:
        minutes: 4
  action:
    - action: mqtt.publish
      data:
        topic: hass/state/dryer
        payload: Drying
        retain: "true"
- id: "17011181757497534"
  alias: Dryer State - Idle
  initial_state: true
  triggers:
    - trigger: numeric_state
      entity_id: sensor.dryer_energy_power
      below: 6
      for:
        minutes: 1
  action:
    - action: mqtt.publish
      data:
        topic: hass/state/dryer
        payload: Idle
        retain: "true"
- id: "17012181747497534"
  alias: "Drying Finished"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: sensor.dryer_state
      from: Drying
      to: Idle
  condition:
    - condition: state
      entity_id: input_boolean.disable_laundry_notifications
      state: "off"
  action:
    - action: media_player.volume_set
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.50"
    - action: tts.google_say
      entity_id: media_player.tv_speakers
      data_template:
        message: Donna or Darren..,Clothes are ready..,The dryer has finished!
    - action: notify.pixels_and_den_tv
      data_template:
        message: "Drying👕👗👖Finished {{ states('sensor.time_12_hour_am_pm') }}"
- id: "170181817174975343345"
  alias: "[Alarmo] Triggered"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: alarm_control_panel.alarmo
      to: triggered
  action:
    - action: notify.mobile_app_pixel_8_pro
      continue_on_error: true
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: "The alarm has been triggered by {{ dict((states|selectattr('entity_id', 'in', state_attr('group.monitored_contacts', 'entity_id'))|list)|groupby('state'))['on']|map(attribute='name')|list|join(', ') }}"
    - action: notify.mobile_app_pixel_5
      continue_on_error: true
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: "The alarm has been triggered by {{ dict((states|selectattr('entity_id', 'in', state_attr('group.monitored_contacts', 'entity_id'))|list)|groupby('state'))['on']|map(attribute='name')|list|join(', ') }}"
    - action: homeassistant.turn_on
      continue_on_error: true
      entity_id: group.alarm_sirens
    - action: noonlight.create_alarm
      continue_on_error: true
      data:
        action: police
    - action: light.turn_on
      continue_on_error: true
      entity_id: light.every_light
    - action: light.turn_on
      continue_on_error: true
      entity_id: light.outside_lights
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.90"
    - delay: "00:00:01"
    - action: tts.google_say
      data:
        cache: true
        entity_id: media_player.tv_speakers
      data_template:
        message: "Alarm triggered! Police has been notified! at {{ states('sensor.time_12_hour_am_pm') }}"
- id: "17016111774977534"
  alias: "[Alarmo] Away Mode Armed"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: alarm_control_panel.alarmo
      to: armed_away
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: Security system armed. The house and grounds are now under video surveillance.
- id: "1701177486112975382884"
  alias: "[Alarmo] Disarmed"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: alarm_control_panel.alarmo
      to: disarmed
  condition:
    - condition: state
      entity_id: input_boolean.naptime
      state: "off"
  action:
    - delay: 5
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: Security system disarmed. You may enter the premises.
- id: "1701612177497534"
  alias: "[Alarmo] Home Mode Armed"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: alarm_control_panel.alarmo
      to: armed_home
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: Security system activated.
- id: "17016131774975342345"
  alias: "[Alarmo] Disarmed and alarm-switch"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: input_boolean.alarm_disarm_switch
      to: "on"
    - trigger: state
      entity_id: alarm_control_panel.alarmo
      from: triggered
      to: disarmed
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: input_boolean.alarm_disarm_switch
              state: "on"
          sequence:
            - action: alarm_control_panel.alarm_disarm
              entity_id: alarm_control_panel.alarmo
              data:
                code: !secret alarm_code
            - action: input_boolean.turn_off
              entity_id: input_boolean.alarm_disarm_switch
        - conditions:
            - condition: state
              entity_id: alarm_control_panel.alarmo
              state: disarmed
          sequence:
            - action: homeassistant.turn_off
              continue_on_error: true
              entity_id:
                - switch.noonlight_switch
                - group.alarm_sirens
            - action: light.turn_off
              continue_on_error: true
              entity_id:
                - light.every_light
                - light.outside_lights
            - action: notify.pixels_and_den_tv
              data_template:
                message: "Alarm canceled at {{ states('sensor.time_12_hour_am_pm') }}"
            - delay: 3
            - action: light.turn_on
              continue_on_error: true
              entity_id:
                - light.sofa_lamp
                - light.cabinet_lights_3
- id: "1701613174749753434567"
  alias: "[Alarmo] Home mode switch"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: input_boolean.alarm_arm_home_switch
      to: "on"
  action:
    - action: script.alarm_arm_home
- id: "1701613117749753498765432"
  alias: "[Alarmo] Away mode switch"
  initial_state: true
  triggers:
    - trigger: state
      entity_id: input_boolean.alarm_arm_away_switch
      to: "on"
  action:
    - action: script.alarm_arm
- id: "17016161677497534"
  alias: "[Alarmo] Auto Night Arm"
  initial_state: true
  triggers:
    - trigger: time
      at: "23:56:00"
  condition:
    - condition: state
      entity_id: alarm_control_panel.alarmo
      state: disarmed
  action:
    - choose:
        - conditions:
            - condition: time
              weekday:
                - fri
                - sat
          sequence:
            - action: notify.mobile_app_pixel_8_pro
              continue_on_error: true
              data:
                message: TTS
                data:
                  ttl: 0
                  priority: high
                  tts_text: The alarm will be activated in three minutes.
            - delay: 180
            - action: script.alarm_arm_home
        - conditions:
            - condition: time
              weekday:
                - sun
                - mon
                - tue
                - wed
                - thu
          sequence:
            - delay: 180
            - action: script.alarm_arm_home
- id: "17071774947534873644"
  alias: "[Alarmo] Someone's awake Disarm alarm"
  mode: single
  triggers:
    - trigger: state
      entity_id: input_boolean.darren_is_awake
      to: "on"
    - trigger: state
      entity_id: input_boolean.donna_is_awake
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.morning_triggered_today
      state: "off"
    - condition: time
      after: "06:00:00"
      before: "11:00:00"
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: and
      conditions:
        - condition: or
          conditions:
            - condition: device
              device_id: 796b669c1f2c31677ae6e0a838928d34
              domain: alarm_control_panel
              entity_id: alarm_control_panel.alarmo
              type: is_armed_home
            - condition: device
              device_id: 796b669c1f2c31677ae6e0a838928d34
              domain: alarm_control_panel
              entity_id: alarm_control_panel.alarmo
              type: is_armed_night
  action:
    - wait_for_trigger:
        - trigger: state
          entity_id:
            - binary_sensor.den_main_motion1
          from: "off"
          to: "on"
        - trigger: state
          entity_id:
            - binary_sensor.kitchen_motion_sensors
          from: "off"
          to: "on"
    - action: script.morning
  initial_state: true
- id: "17016181157497534"
  alias: Notify us when the garage door opens and no one home
  triggers:
    - trigger: state
      entity_id: group.person_group
      to: not_home
      for:
        minutes: 2
  condition:
    - condition: state
      entity_id: cover.garage_door
      state: open
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: TTS
        data:
          ttl: 0
          priority: high
          tts_text: The garage is open.
    - delay: 5
    - action: notify.notify_all
      data:
        message: The garage is open and no one is home!!!
        data:
          color: red
          actions:
            - action: close_garage
              title: Close Garage Door
        title: GARAGE IS OPEN
- id: "17016181274497534"
  alias: Close the garage when notification action is tapped
  trigger:
    trigger: event
    event_type: mobile_app_notification_action
    event_data:
      action: close_garage
  action:
    action: cover.close_cover
    entity_id: cover.garage_door
- id: "17016181237497534"
  alias: Notify when desk light goes off
  triggers:
    - trigger: state
      entity_id:
        - light.desk_light
      to: "off"
  condition:
    - condition: state
      entity_id: person.darren
      state: not_home
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: Desk light off
        data:
          color: red
          actions:
            - action: turn_on
              title: Turn light on
- id: "17016181474697534"
  alias: Turn desk light on when notification action is tapped
  trigger:
    trigger: event
    event_type: mobile_app_notification_action
    event_data:
      action: turn_on
  action:
    action: light.turn_on
    entity_id: light.desk_light
- id: "17016181374977534434343"
  alias: Notify when AC unit goes off
  triggers:
    - trigger: state
      entity_id:
        - climate.den
      to: "off"
      for:
        minutes: 1
  action:
    - action: notify.notify_all
      data:
        message: A/C Unit is off
        data:
          color: red
          actions:
            - action: turn_on_ac
              title: Turn AC on
- id: "17016181474947534545454"
  alias: Turn AC unit on when notification action is tapped
  triggers:
    - trigger: event
      event_type: mobile_app_notification_action
      event_data:
        action: turn_on_ac
  action:
    - delay: 00:05:00
    - action: homeassistant.turn_on
      entity_id: climate.den

- id: "4271663334274859"
  description: ""
  alias: AI Event Porch
  use_blueprint:
    path: valentinfrlch/event_summary.yaml
    input:
      camera_entities:
        - camera.porch_camera_0
      motion_sensors:
        - binary_sensor.front_door
        - binary_sensor.front_motion
        - binary_sensor.front_porch_motion
      duration: 6
      provider: 01JZ8Q8C7HDXYKWP5JF8M4ECFX
      notify_device:
        - 5402f427ac93601eeab00b7fc7d6f6da
      preview_mode: Snapshot
      tap_navigate: /dashboard-test/streams
      notification_color: "#ffeb3b"
      notification_channel: alarm_stream
      tts_notification: true
      tts_volume: alarm_stream_max
      model: gpt-4o-mini

- id: "17016499927893058"
  alias: Update notifications
  use_blueprint:
    path: mdegat01/update_notifications.yaml
    input:
      reminder_hours: "3"
      update_entities:
        - update.docker_wyze_bridge_update
        - update.home_assistant_core_update
        - update.home_assistant_google_drive_backup_update
        - update.home_assistant_operating_system_update
        - update.home_assistant_supervisor_update
        - update.zerotier_one_update
        - update.mariadb_update
        - update.network_ups_tools_update
        - update.mosquitto_broker_update
        - update.nginx_home_assistant_ssl_proxy_update
        - update.silicon_labs_multiprotocol_update
        - update.studio_code_server_update
      mobile_app_device: 5402f427ac93601eeab00b7fc7d6f6da
      send_to_ha: true
      take_backup: false
      only_before: "23:00:00"
      only_after: 07:00:00
      run_config_check: false
      mobile_app_device_2: fcffc10d5913eb61a8616787b322450e
- id: "17016506815125772"
  alias: UPS Power OFF
  trigger:
    - type: voltage
      trigger: device
      device_id: ce3cd90f8063fc682a2d4d1767be5165
      entity_id: sensor.mainups_input_voltage
      domain: sensor
      below: 10
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: The Power went OFF at {{ states('sensor.time_12_hour_am_pm') }}
        title: Smart Home Alert
  mode: single
- id: "17016506828368235"
  alias: UPS Online and fully charged
  trigger:
    - type: battery_level
      trigger: device
      device_id: ce3cd90f8063fc682a2d4d1767be5165
      entity_id: sensor.mainups_battery_charge
      domain: sensor
      above: 99
  condition:
    - type: is_voltage
      condition: device
      device_id: ce3cd90f8063fc682a2d4d1767be5165
      entity_id: sensor.mainups_input_voltage
      domain: sensor
      above: 120
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        title: Smart Home Alert
        message:
          UPS is online and fully charged at {{ states('sensor.time_12_hour_am_pm')
          }}
  mode: single
- id: "170165068283468355"
  alias: UPS changed state
  triggers:
    - trigger: event
      event_type: nut.ups_event
  action:
    - action: notify.mobile_app_pixel_8_pro
      data_template:
        title: UPS changed state
        message: "{{ trigger.event.data.notify_msg }}"
- id: "17016703383649836"
  alias: TV Ambient lights ON when TV is on
  triggers:
    - trigger: state
      entity_id:
        - remote.den_tv
      to: "on"
  action:
    - action: homeassistant.turn_on
      target:
        device_id: bc73bb14e38e8396900015b6b0d86506
  mode: single
- id: "17016780383725624"
  alias: TV Ambient lights OFF when TV off
  triggers:
    - trigger: state
      entity_id:
        - remote.den_tv
      to: "off"
  action:
    - action: homeassistant.turn_off
      target:
        device_id: bc73bb14e38e8396900015b6b0d86506
  mode: single
- id: "17016473051966192"
  alias: Doorbell
  triggers:
    - trigger: device
      device_id: 011d22447a45c26939459e4d099889cb
      domain: nest
      type: camera_person
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: Person Detected at Front door
        title: Someone is at Front door
        data:
          image: /api/nest/event_media/{{ trigger.event.data.device_id }}/{{ trigger.event.data.nest_event_id }}/thumbnail
    - action: notify.android_tv_fire_tv
      data:
        message: Person Detected at Front door
        title: Someone is at Front door

- id: "17016482488751674"
  alias: Theme change for Island video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: island
  action:
    - action: script.browser_theme_orange
  mode: single
- id: "17016852488856489"
  alias: Theme change for waves video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: waves
  action:
    - action: script.browser_theme_orange
  mode: single
#- id: "17019682488958358"
#  alias: Theme change for space video
#  triggers:
#   - trigger: state
#      entity_id:
#        - input_select.video_wallpaper
#      to: space
#  action:
#    - action: script.browser_theme_blue
#  mode: single
- id: "17016824889058894"
  alias: Theme change for nightClouds video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: nightClouds
  action:
    - action: script.browser_theme_ocean
  mode: single
- id: "17016842489168384"
  alias: Theme change for greenNeon video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: greenNeon
  action:
    - action: script.browser_theme_lime
  mode: single
- id: "17016282489302842"
  alias: Theme change for moonRising video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: moonRising
  action:
    - action: script.browser_theme_orange
  mode: single
- id: "17016824849385397"
  alias: Theme change for berry video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: berry
  action:
    - action: script.browser_theme_purple
  mode: single
- id: "17011682489641350"
  alias: Theme change for orangeSunset video
  description: Theme change for orangeSunset video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: orangeSunset
  action:
    - action: script.browser_theme_orange
  mode: single
- id: "17016582489708685"
  alias: Theme change for inferno video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: inferno
  action:
    - action: script.browser_theme_orange
  mode: single
- id: "17016682490776105"
  alias: Theme change for fireworks video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: fireworks
  action:
    - action: script.browser_theme_red
  mode: single
- id: "17016282491409399"
  alias: Theme change for fullMoon video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: fullMoon
  action:
    - action: script.browser_theme_orange
  mode: single
- id: "17016827494516919"
  alias: Theme change for Fire video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: fire
  action:
    - action: script.browser_theme_orange
  mode: single
- id: "17016825351619303"
  alias: Theme change for darkskyMoon video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: darkskyMoon
  action:
    - action: script.browser_theme_magenta
  mode: single
- id: "17016282536189205"
  alias: Theme change for spookyMoon video
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: spookyMoon
  action:
    - action: script.browser_theme_grey
  mode: single
- id: "17017683173367800"
  alias: Theme change for beachyWaves
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: beachyWaves
  action:
    - action: script.browser_theme_orange
  mode: single
- id: "17016883173615818"
  alias: Theme change for cloudyMoon
  triggers:
    - trigger: state
      entity_id:
        - input_select.video_wallpaper
      to: cloudyMoon
  action:
    - action: script.browser_theme_blue
  mode: single
- id: "1741695422320496"
  alias: Reset Home Screen
  description: Reset Home Screen on Mobile every 15 mins
  triggers:
    - trigger: time_pattern
      minutes: /15
      enabled: true
  action:
    - action: input_select.select_option
      data:
        option: mobile3
      target:
        entity_id: input_select.mobilelayout
  mode: single
- id: "17081207628341"
  alias: Bathroom motion low battery
  trigger:
    - type: battery_level
      trigger: device
      device_id: 1f1dda5c9dba4825c89a35eddc9ac5dc
      entity_id: aea3e136eb73087cf415d3ec530bbfad
      domain: sensor
      below: 35
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: Bathroom motion battery is below 35%
        title: BATTERY LOW
  mode: single
- id: "17091227643669"
  alias: "[AUTO] Bathroom vent when door opened"
  trigger:
    - type: opened
      trigger: device
      device_id: ddfdaa597a6f3d5253692718365c95a1
      entity_id: 7d7ea576c802654a8876e7ae82d10add
      domain: binary_sensor
  action:
    - action: switch.turn_on
      target:
        entity_id: switch.bathroom_vent
    - delay:
        minutes: 3
    - action: switch.turn_off
      target:
        entity_id: switch.bathroom_vent
  mode: restart
- id: "170112684169772"
  alias: Sports sensor update
  triggers:
    - trigger: time_pattern
      seconds: "59"
  condition:
    - condition: state
      entity_id: input_boolean.sports_updates
      state: "on"
  action:
    - action: homeassistant.update_entity
      target:
        entity_id:
          - sensor.predators
          - sensor.atlanta_braves
          - sensor.saints
          - sensor.titans
  mode: single
- id: "170132997235605"
  alias: Kitchen 2 motion pic
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.kitchen_bt_motion_2
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
      enabled: true
  action:
    - action: button.press
      target:
        entity_id: button.wyze_cam_kitchen_cam_2_update_snapshot
    - delay:
        seconds: 4
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: Kitchen Motion at {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_kitchen_cam_2_snapshot?token={{ state_attr('camera.wyze_cam_kitchen_cam_2_snapshot','access_token')
            }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
  mode: single
- id: "170143000782411"
  alias: Kitchen 1 motion pic
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.kitchen_bt_motion
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
      enabled: true
  action:
    - action: button.press
      target:
        entity_id: button.wyze_cam_kitchen_cam_update_snapshot
    - delay:
        seconds: 8
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: Kitchen Motion at {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image:
            /api/camera_proxy/camera.wyze_cam_kitchen_cam_snapshot?token={{ state_attr('camera.wyze_cam_kitchen_cam_snapshot','access_token')
            }}
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /lovelace/cameras
  mode: single
- id: "170153002392645"
  alias: Front Door Last motion pic
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.front_porch_motion
      to: "on"
    - trigger: device
      device_id: 011d22447a45c26939459e4d099889cb
      domain: nest
      type: camera_person
  action:
    - action: camera.snapshot
      target:
        entity_id: camera.porch_camera_0
      data:
        filename: /config/www/tmp/last_snapshot_porch.jpg
    #    - action: camera.record
    #      target:
    #        entity_id: camera.porch_camera_0
    #      data:
    #        filename: /config/www/tmp/last_video_snapshot_porch.mp4
    #        duration: 12
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /dashboard-cast/porch
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /dashboard-cast/porch
    - action: input_boolean.turn_on
      entity_id: input_boolean.camera_motion_detected
    - delay:
        seconds: 2
    - action: notify.notify_all
      data:
        message: ⚠️Front Motion!⚠️️ {{ states('sensor.worldclock_sensor_12hr') }}
        data:
          notification_icon: mdi:cctv
          image: /local/tmp/last_snapshot_porch.jpg
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: dashboard-cast/porch
    - choose:
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_snapshots
              state: "on"
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.ensuite_display
                volume_level: "0.3"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.ensuite_display
                message: Motion at front door
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream porch camera on office display"
            - delay: 240
            - action: media_player.turn_off
              continue_on_error: true
              data:
                entity_id: media_player.ensuite_display
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_snapshots
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
            - condition: state
              entity_id: group.person_group
              state: not_home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.80"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion at front door
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream porch camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_snapshots
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
            - condition: state
              entity_id: group.person_group
              state: home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.80"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion at front door
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream porch camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
    - delay: 120
    - action: input_boolean.turn_off
      entity_id: input_boolean.camera_motion_detected
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /lovelace/newtab
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/newtab
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.2"
    - delay: 2
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.office_display
        volume_level: "0.2"
  mode: single
  max_exceeded: silent
- id: "170163035746544"
  alias: Notify of Camera channel importance
  trigger: []
  action:
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: Motion Detected
        data:
          channel: Cameras
          ledColor: red
- id: "170173036339632"
  alias: Side Door Last motion pic
  description: ""
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.side_motion_sensor
      to: "on"
  condition: []
  action:
    - action: camera.snapshot
      target:
        entity_id: camera.driveway_0
      data:
        filename: /config/www/tmp/last_snapshot_driveway.jpg
    #    - action: camera.record
    #      continue_on_error: true
    #      target:
    #        entity_id: camera.driveway_0
    #      data:
    #        filename: /config/www/tmp/last_video_snapshot_driveway.mp4
    #        duration: 12
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /dashboard-cast/driveway
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /dashboard-cast/driveway
    - action: input_boolean.turn_on
      entity_id: input_boolean.camera_motion_detected
    - delay:
        seconds: 2
    - action: notify.notify_all
      data:
        message: ⚠️Side Door Motion!⚠️️{{ states('sensor.worldclock_sensor_12hr') }}
        data:
          notification_icon: mdi:cctv
          image: /local/tmp/last_snapshot_driveway.jpg
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Camera
              uri: /dashboard-cast/driveway
    - choose:
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_snapshots
              state: "on"
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.ensuite_display
                volume_level: "0.3"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.ensuite_display
                message: Motion at side door
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream driveway camera on office display"
            - delay: 240
            - action: media_player.turn_off
              continue_on_error: true
              data:
                entity_id: media_player.ensuite_display
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_snapshots
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
            - condition: state
              entity_id: group.person_group
              state: not_home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.6"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion at side door
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream driveway camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
        - conditions:
            - condition: state
              entity_id: input_boolean.camera_snapshots
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
            - condition: state
              entity_id: group.person_group
              state: home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.6"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion at side door
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream driveway camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
    - delay: 120
    - action: input_boolean.turn_off
      entity_id: input_boolean.camera_motion_detected
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /lovelace/newtab
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/newtab
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.2"
    - delay: 2
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.office_display
        volume_level: "0.2"
  mode: single
  max_exceeded: silent
- id: "170183046792101"
  alias: Back Door Last motion pic
  description: ""
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.back_motion
      to: "on"
  condition: []
  action:
    - action: camera.snapshot
      target:
        entity_id: camera.patio_0
      data:
        filename: /config/www/tmp/last_snapshot_patio.jpg
    #    - action: camera.record
    #      continue_on_error: true
    #      target:
    #        entity_id: camera.patio_0
    #      data:
    #        filename: /config/www/tmp/last_video_snapshot_patio.mp4
    #        duration: 12
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /dashboard-cast/patio
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /dashboard-cast/patio
    - action: input_boolean.turn_on
      entity_id: input_boolean.camera_motion_detected
    - delay:
        seconds: 2
    - action: notify.notify_all
      data:
        message: ⚠️Patio Motion!⚠️️{{ states('sensor.worldclock_sensor_12hr') }} # ️{{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: mdi:cctv
          image: /local/tmp/last_snapshot_patio.jpg
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /dashboard-cast/patio
    - choose:
        - conditions:
            - condition: state
              entity_id: input_boolean.patio_garage_alerts
              state: "on"
            - condition: time
              after: "22:00:00"
              before: "07:00:00"
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.office_display
                volume_level: "0.3"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.office_display
                message: motion on patio
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream patio camera on office display"
            - delay: 240
            - action: media_player.turn_off
              continue_on_error: true
              data:
                entity_id: media_player.ensuite_display
        - conditions:
            - condition: state
              entity_id: input_boolean.patio_garage_alerts
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
            - condition: state
              entity_id: group.person_group
              state: not_home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.6"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: motion on patio
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream patio camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
        - conditions:
            - condition: state
              entity_id: input_boolean.patio_garage_alerts
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "21:59:59"
            - condition: state
              entity_id: group.person_group
              state: home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.6"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: motion on patio
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream patio camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
    - delay: 120
    - action: input_boolean.turn_off
      entity_id: input_boolean.camera_motion_detected
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /lovelace/newtab
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/newtab
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.3"
    - delay: 2
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.office_display
        volume_level: "0.2"
  mode: single
  max_exceeded: silent
- id: "170193047329426"
  alias: Garage Last motion pic
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.garage_motion_sensors
      to: "on"
  condition: []
  action:
    - action: camera.snapshot
      target:
        entity_id: camera.garage_0
      data:
        filename: /config/www/tmp/last_snapshot_garage.jpg
    #    - action: camera.record
    #      continue_on_error: true
    #      target:
    #        entity_id: camera.garage_0
    #      data:
    #        filename: /config/www/tmp/last_video_snapshot_garage.mp4
    #        duration: 12
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /dashboard-cast/garage
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /dashboard-cast/garage
    - action: input_boolean.turn_on
      entity_id: input_boolean.camera_motion_detected
    - delay:
        seconds: 2
    - action: notify.notify_all
      data:
        message: ⚠️Garage Motion!⚠️️ {{ states('sensor.worldclock_sensor_12hr') }}
        data:
          notification_icon: mdi:cctv
          image: /local/tmp/last_snapshot_patio.jpg
          persistent: true
          color: red
          channel: Cameras
          tag: Motion
          actions:
            - action: URI
              title: Click to Open Cameras
              uri: /dashboard-cast/garage
    - choose:
        - conditions:
            - condition: state
              entity_id: input_boolean.patio_garage_alerts
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "22:00:00"
            - condition: state
              entity_id: group.person_group
              state: not_home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.6"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion in the garage
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream garage camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
        - conditions:
            - condition: state
              entity_id: input_boolean.patio_garage_alerts
              state: "on"
            - condition: time
              after: "07:00:01"
              before: "22:00:00"
            - condition: state
              entity_id: group.person_group
              state: home
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.tv_speakers
                volume_level: "0.6"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.tv_speakers
                message: Motion in the garage
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream garage camera on den TV"
            - delay: 180
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "turn off den TV"
        - conditions:
            - condition: state
              entity_id: input_boolean.patio_garage_alerts
              state: "on"
            - condition: time
              after: "22:00:01"
              before: "07:00:00"
          sequence:
            - action: media_player.volume_set
              continue_on_error: true
              data:
                entity_id: media_player.ensuite_display
                volume_level: "0.3"
            - action: tts.google_say
              continue_on_error: true
              data:
                cache: true
                entity_id: media_player.ensuite_display
                message: Motion in garage
            - action: google_assistant_sdk.send_text_command
              continue_on_error: true
              data:
                command: "stream garage camera on office display"
            - delay: 240
            - action: media_player.turn_off
              continue_on_error: true
              data:
                entity_id: media_player.ensuite_display
    - delay: 120
    - action: input_boolean.turn_off
      entity_id: input_boolean.camera_motion_detected
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - 1b918469-5d6a2b44
        path: /lovelace/newtab
    - action: browser_mod.navigate
      continue_on_error: true
      data:
        browser_id:
          - ac9b7f58-cfbfe785
        path: /lovelace/newtab
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.tv_speakers
        volume_level: "0.40"
  mode: single
  max_exceeded: silent
- id: "170203097871969"
  alias: "[Motion] Side Motion Lights after Dark"
  triggers:
    - trigger: state
      entity_id: binary_sensor.side_motion_sensor
      from: "off"
      to: "on"
  condition:
    - condition: or
      conditions:
        - condition: sun
          after: sunset
          after_offset: 45
        - condition: sun
          before: sunrise
          before_offset: 45
  action:
    - action: light.turn_on
      entity_id: light.front_yard_lights
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.side_motion_sensor
          from: "on"
          to: "off"
    - delay: 300
    - action: light.turn_off
      entity_id: light.front_yard_lights
  mode: restart
  max_exceeded: silent
- id: "170223138270251"
  alias: "[Motion] Garage Motion Lights"
  triggers:
    - trigger: state
      entity_id: binary_sensor.garage_occupied # binary_sensor.garage_motion_sensors
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - choose:
        - conditions:
            - condition: time
              before: "21:29:59"
              after: 09:00:01
          sequence:
            - action: light.turn_on
              data:
                brightness_pct: 100
              target:
                entity_id: light.garage_lights
        - conditions:
            - condition: time
              before: 09:00:00
              after: "21:30:00"
          sequence:
            - action: light.turn_on
              data:
                brightness_pct: 35
              target:
                entity_id: light.garage_lights
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.garage_occupied
          from: "on"
          to: "off"
          for:
            minutes: 10
    - action: light.turn_off
      data:
        entity_id: light.garage_lights
  mode: restart
  max_exceeded: silent
- id: "170233166895065"
  alias: Darren's Alarm Pixel 8 pro next alarm
  triggers:
    - trigger: template
      value_template:
        "{{ states('sensor.date_time') == (as_timestamp(states.sensor.pixel_8_pro_next_alarm.state)
        |int -1)| timestamp_custom('%Y-%m-%d, %H:%M', True) }} "
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
    - condition: state
      entity_id: input_boolean.darren_s_alarm_triggered_today
      state: "off"
    - condition: state
      entity_id: person.darren
      state: home
  action:
    - action: script.darrens_wake_up
  mode: single
- id: "1703172027074"
  alias: Donna's Alarm Pixel 5 next alarm
  triggers:
    - trigger: template
      value_template:
        "{{ states('sensor.date_time') == (as_timestamp(states.sensor.pixel_5_next_alarm.state)
        |int -1)| timestamp_custom('%Y-%m-%d, %H:%M', True) }} "
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
    - condition: state
      entity_id: input_boolean.donna_s_alarm_triggered_today
      state: "off"
    - condition: state
      entity_id: person.donna
      state: home
  action:
    - action: script.donnas_wake_up
  mode: single
- id: "170243184400922"
  alias: "[Motion] Guest Motion Lights"
  triggers:
    - trigger: state
      entity_id: binary_sensor.guest_room_motion
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - action: light.turn_on
      entity_id: light.night_light_6, light.guest_night_lights
  mode: single
  max_exceeded: silent
- id: "17025318794468582"
  alias: "[Motion] Someone's at the Table"
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.kitchen_table_motion_sensors
      to: "on"
  condition:
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - action: light.turn_on
      target:
        device_id: 760cfce120cdf3eedbaa7f35d36aa2db
    - wait_for_trigger:
        - trigger: state
          entity_id:
            - binary_sensor.kitchen_table_motion_sensors
          from: "on"
          to: "off"
    - delay:
        minutes: 15
    - action: light.turn_off
      target:
        device_id: 760cfce120cdf3eedbaa7f35d36aa2db
  mode: restart
  max_exceeded: silent
- id: "1703196844652"
  alias: "[Motion] Hall Bathroom Lights"
  triggers:
    - trigger: state
      entity_id: binary_sensor.bathroom_motion_motion
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: light.bathroom_lights
              state: "on"
          sequence:
            - delay: 3
        - conditions:
            - condition: time
              before: "08:29:59"
              after: 06:00:01
          sequence:
            - action: light.turn_on
              entity_id: light.bathroom_lights
        - conditions:
            - condition: time
              before: "19:59:59"
              after: 08:30:00
          sequence:
            - action: light.turn_on
              entity_id: light.bathroom_lights
        - conditions:
            - condition: time
              before: "22:29:59"
              after: "20:00:00"
          sequence:
            - action: light.turn_on
              entity_id: light.bathroom_lights
        - conditions:
            - condition: time
              before: 06:00:00
              after: "22:30:00"
          sequence:
            - action: light.turn_on
              target:
                entity_id: light.bathtub_light
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.bathroom_motion_motion
          from: "on"
          to: "off"
    - delay: 70
    - condition: state
      entity_id: binary_sensor.bathroom_door_bt
      state: "on"
      enabled: true
    - action: light.turn_off
      entity_id: light.bathroom_lights
  mode: restart
  max_exceeded: silent
- id: "170263206754260"
  alias: "[Motion] Bedroom Motion Lights"
  triggers:
    - trigger: state
      entity_id: binary_sensor.bedroom_motion_sensors
      from: "off"
      to: "on"
  condition:
    - condition: state
      entity_id: binary_sensor.bedroom_door
      state: "on"
    - condition: state
      entity_id: group.person_group
      state: home
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
  action:
    - choose:
        - conditions:
            - condition: time
              after: "09:30:00"
              before: "18:30:00"
              enabled: true
          sequence:
            - action: light.turn_on
              continue_on_error: true
              entity_id: light.mood_lights
            - action: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 45
              target:
                entity_id: light.donnas_light
            - action: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 45
              target:
                entity_id: light.darrens_light
            - action: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
        - conditions:
            - condition: time
              after: "18:30:01"
              before: "20:30:00"
              enabled: true
          sequence:
            - action: light.turn_on
              continue_on_error: true
              entity_id: light.mood_lights
            - action: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 15
              target:
                entity_id: light.donnas_light
            - action: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 15
              target:
                entity_id: light.darrens_light
            - action: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
        - conditions:
            - condition: time
              after: "20:30:01"
              before: "21:30:00"
              enabled: true
          sequence:
            - action: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 5
              target:
                entity_id: light.donnas_light
            - action: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 5
              target:
                entity_id: light.darrens_light
            - action: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
        - conditions:
            - condition: time
              after: "21:30:01"
              before: "22:30:00"
              enabled: true
          sequence:
            - action: light.turn_on
              continue_on_error: true
              data:
                brightness_pct: 5
              target:
                entity_id: light.donnas_light
            - action: switch.turn_on
              continue_on_error: true
              entity_id: switch.ensuite_kiosk_screen
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.bedroom_motion_sensors
          from: "on"
          to: "off"
    - delay: 800
    - action: light.turn_off
      entity_id: light.mood_lights
      continue_on_error: true
    - delay: 800
    - action: light.turn_off
      continue_on_error: true
      entity_id: light.darrens_light
    - delay: 1800
    - action: light.turn_off
      continue_on_error: true
      entity_id: light.donnas_light
    - action: switch.turn_off
      continue_on_error: true
      entity_id: switch.ensuite_kiosk_screen
  mode: restart
  max_exceeded: silent
- id: "19317603288153054"
  alias: "Patio LEDs ON at sunset"
  mode: single
  triggers:
    - trigger: sun
      event: sunset
      offset: "+00:20:00"
  actions:
    - type: turn_on
      device_id: ea11a241127e97442fb1c99327e49b59
      entity_id: 914303f3da00efeb0ba5e45707be8974
      domain: switch
- id: "19936353603288153054"
  alias: "Patio LEDs ON when Donna is awake"
  mode: single
  triggers:
    - trigger: state
      entity_id: binary_sensor.donna_is_awake
      to: "on"
  condition:
    - condition: sun
      before: sunrise
      before_offset: 45
  actions:
    - type: turn_on
      device_id: ea11a241127e97442fb1c99327e49b59
      entity_id: 914303f3da00efeb0ba5e45707be8974
      domain: switch
    - wait_for_trigger:
        - trigger: state
          entity_id: person.donna
          to: not_home
    - type: turn_off
      device_id: ea11a241127e97442fb1c99327e49b59
      entity_id: 914303f3da00efeb0ba5e45707be8974
      domain: switch
- id: "170273218670383"
  alias: Front Door TTS
  triggers:
    - trigger: state
      entity_id: binary_sensor.front_door
      to: "on"
    - trigger: state
      entity_id: binary_sensor.front_door
      to: "off"
  condition:
    - condition: state
      entity_id: input_boolean.door_announcements
      state: "on"
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - action: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          {% if is_state("binary_sensor.front_door", "on") %}
            Front door opened
          {% elif is_state("binary_sensor.front_door", "off") %}
            Front door closed
          {% else %} {% endif %}
    - action: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.front_door", "on") %}
            ⚠️Front Door🚪opened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.front_door", "off") %}
            ⚠️Front Door🚪closed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued
- id: "170283218843560"
  alias: Back Door TTS
  triggers:
    - trigger: state
      entity_id: binary_sensor.back_door1, binary_sensor.backdoor_bt_sensor
      to: "on"
    - trigger: state
      entity_id: binary_sensor.back_door1, binary_sensor.backdoor_bt_sensor
      to: "off"
  condition:
    - condition: state
      entity_id: input_boolean.door_announcements
      state: "on"
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - action: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          {% if is_state("binary_sensor.back_door1", "on") %}
            Back door opened
          {% elif is_state("binary_sensor.back_door1", "off") %}
            Back door closed
          {% else %} {% endif %}
    - action: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.back_door1", "on") %}
            ⚠️Back Door🚪opened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.back_door1", "off") %}
            ⚠️Back Door🚪closed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued
- id: "170293219333914"
  alias: Side Door TTS
  triggers:
    - trigger: state
      entity_id: binary_sensor.side_door_bt
      to: "on"
    - trigger: state
      entity_id: binary_sensor.side_door_bt
      to: "off"
  condition:
    - condition: state
      entity_id: input_boolean.door_announcements
      state: "on"
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - action: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          {% if is_state("binary_sensor.side_door_bt", "on") %}
            Side door opened
          {% elif is_state("binary_sensor.side_door_bt", "off") %}
            Side door closed
          {% else %} {% endif %}
    - action: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.side_door_bt", "on") %}
            ⚠️Side Door🚪opened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.side_door_bt", "off") %}
            ⚠️Side Door🚪closed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued
- id: "170323250576301"
  alias: Garage Door TTS
  triggers:
    - trigger: state
      entity_id: binary_sensor.garage_door_sensor_zb
      to: "on"
    - trigger: state
      entity_id: binary_sensor.garage_door_sensor_zb
      to: "off"
  condition:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
  action:
    - action: tts.google_say
      entity_id: media_player.living_room_google
      data_template:
        message: |
          {% if is_state("binary_sensor.garage_door_sensor_zb", "on") %}
            Garage door opened
          {% elif is_state("binary_sensor.garage_door_sensor_zb", "off") %}
            Garage door closed
          {% else %} {% endif %}
    - action: notify.android_tv_fire_tv
      data_template:
        data:
          fontsize: "large"
          position: "bottom-right"
          duration: 3
          transparency: "25%"
          color: "grey"
          interrupt: 1
        message: |
          {% if is_state("binary_sensor.garage_door_sensor_zb", "on") %}
            ⚠️Garage Door⚠️opened {{ states('sensor.time_12_hour_am_pm') }}
          {% elif is_state("binary_sensor.garage_door_sensor_zb", "off") %}
            ⚠️Garage Door⚠️closed {{ states('sensor.time_12_hour_am_pm') }}
          {% else %} {% endif %}
  mode: queued

- id: "170343250676301455712"
  alias: "Donna is awake"
  mode: restart
  triggers:
    - trigger: state
      entity_id:
        - light.bedroom_lights
      to: "on"
      for:
        seconds: 3
  condition:
    - condition: time
      before: "11:00:00"
      after: "05:00:00"
  action:
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.bedroom_door
          to: "on"
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.donna_is_awake
- id: "17034325444301455712"
  alias: "Darren is awake"
  mode: single
  triggers:
    - trigger: state
      entity_id:
        - light.office_lights
      to: "on"
      for:
        seconds: 3
  condition:
    - condition: time
      before: "11:00:00"
      after: "05:00:00"
  action:
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.office_motion_sensors
          to: "on"
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.darren_is_awake
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.naptime
    - action: switch.turn_on
      target:
        entity_id: switch.ha2_office_monitor
    - action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id: media_player.office_display
        volume_level: "0.40"
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: command_broadcast_intent
        data:
          intent_package_name: com.urbandroid.sleep
          intent_action: com.urbandroid.sleep.alarmclock.STOP_SLEEP_TRACK
          ttl: 0
          priority: high
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.door_announcements
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.radar_updates
    - action: switch.turn_on
      target:
        entity_id: switch.keurig_coffee
- id: "1703432544430144455712"
  alias: "Everyone is awake"
  mode: single
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.everyone_awake
      to: "on"
  action:
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.everyone_is_awake
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.door_announcements
    - delay:
        hours: 1
    - action: media_player.volume_set
      target:
        entity_id: media_player.living_room_google
      data:
        volume_level: 0.45

- id: "17033325058863014567"
  alias: Office auto fan
  triggers:
    - trigger: numeric_state
      entity_id: sensor.office_temperature_2
      above: 75.5
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
  action:
    - action: fan.turn_on
      target:
        entity_id: fan.office_fan
- id: "17933325058863014567"
  alias: Office auto fan OFF
  triggers:
    - trigger: numeric_state
      entity_id: sensor.office_temperature_2
      below: 74
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
  action:
    - action: fan.turn_off
      target:
        entity_id: fan.office_fan

- id: "170333943278863014567"
  alias: Guest auto fan ON
  triggers:
    - trigger: numeric_state
      entity_id: sensor.guest_room_temperature
      above: 75.5
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
  action:
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.guest_ceiling_fan
    - action: google_assistant_sdk.send_text_command
      continue_on_error: true
      data:
        command: "turn on guest ceiling fan"
- id: "179657711058863014567"
  alias: Guest auto fan OFF
  triggers:
    - trigger: numeric_state
      entity_id: sensor.guest_room_temperature
      below: 74
  condition:
    - condition: state
      entity_id: group.person_group
      state: not_home
  action:
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.guest_ceiling_fan
    - action: google_assistant_sdk.send_text_command
      continue_on_error: true
      data:
        command: "turn off guest ceiling fan"
- id: "170883399227153856993332311"
  alias: Romance Time
  description: ""
  mode: single
  triggers:
    - trigger: device
      device_id: b91c3dd0f0e777342b0b6792efcb8dff
      domain: bthome
      type: button
      subtype: double_press
    - trigger: state
      entity_id:
        - input_boolean.romance_time
      to: "on"
    - trigger: state
      entity_id:
        - input_boolean.romance_time_2
      to: "on"
  action:
    - action: light.turn_off
      target:
        entity_id: light.bedroom_lights
    - action: light.turn_on
      target:
        entity_id: light.nightstand_lamps
      data:
        color_name: red
        brightness_pct: 4
    - action: media_player.play_media
      target:
        entity_id: media_player.bedroom_stereo
      data:
        media_content_id: spotify://track/1gyHbU6CPUp1OkdoElP3Fo
        media_content_type: music
      metadata:
        title: Passionista - Tease Her Until She Explodes
        thumbnail: https://i.scdn.co/image/ab67616d0000b27327ede73f025d18dd8a083b37
        media_class: track
        children_media_class: null
        navigateIds:
          - {}
          - media_content_type: music_assistant
            media_content_id: playlists
          - media_content_type: music
            media_content_id: library://playlist/15
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.romance_time
    - action: input_boolean.turn_off
      target:
        entity_id: input_boolean.romance_time_2
- id: "17192624372243592387"
  alias: Ensuite motion light on
  triggers:
    - trigger: state
      entity_id:
        - binary_sensor.ensuite_motion_sensors
      to: "on"
  condition:
    - condition: time
      before: "22:00:00"
      after: "19:00:00"
    - condition: state
      entity_id: binary_sensor.night
      state: "on"
    - condition: state
      entity_id: light.jacuzzi_light
      state: "off"
  action:
    - action: light.turn_on
      target:
        entity_id: light.jacuzzi_light
    - action: light.turn_on
      target:
        entity_id: light.donnas_light
    - choose:
        - conditions:
            - condition: state
              entity_id: switch.ensuite_kiosk_screen
              state: "off"
          sequence:
            - action: switch.turn_on
              entity_id: switch.ensuite_kiosk_screen
            - delay: 2
            - action: button.press
              target:
                entity_id: button.ensuite_kiosk_load_start_url
        - conditions:
            - condition: state
              entity_id: switch.ensuite_kiosk_screen
              state: "on"
          sequence:
            - delay: 2
            - action: button.press
              target:
                entity_id: button.ensuite_kiosk_load_start_url
    - wait_for_trigger:
        - trigger: state
          entity_id: binary_sensor.ensuite_motion_sensors
          from: "on"
          to: "off"
    - delay:
        minutes: 120
    - action: light.turn_off
      continue_on_error: true
      entity_id: light.jacuzzi_light
    - action: switch.turn_off
      continue_on_error: true
      entity_id: switch.ensuite_kiosk_screen
  mode: restart
  max_exceeded: silent
- id: "17692637954621642387"
  alias: "Mailbox Opened"
  mode: queued
  trigger:
    - type: opened
      trigger: device
      device_id: 36598d5759f923c08a41bacff5b869ac
      entity_id: e8b3607933bd162bd10ead26edd60570
      domain: binary_sensor
  action:
    - action: media_player.volume_set
      data:
        volume_level: 0
      target:
        entity_id: media_player.living_room_google
    - action: media_player.turn_on
      target:
        entity_id: media_player.living_room_google
    - delay: 1
    - action: media_player.volume_set
      data:
        volume_level: 0.7
      target:
        entity_id: media_player.living_room_google
    - delay: 1
    - action: media_player.play_media
      target:
        entity_id: media_player.living_room_google
      data:
        media_content_id: media-source://media_source/local/youve-got-mail-sound.mp3
        media_content_type: audio/mpeg
      metadata:
        title: youve-got-mail-sound.mp3
        thumbnail: null
        media_class: music
        children_media_class: null
        navigateIds:
          - {}
          - media_content_type: app
            media_content_id: media-source://media_source
    - action: script.tts_alerts_mailbox
    - action: notify.mobile_app_pixel_8_pro
      data:
        message: Mailbox opened at {{ states('sensor.time_12_hour_am_pm') }}
        data:
          notification_icon: "mdi:mailbox"
          visibility: public
    - delay: 4
    - action: media_player.volume_set
      data:
        volume_level: 0.4
      target:
        entity_id: media_player.living_room_google
- id: "17792621454621642333"
  alias: Battery Low Notification
  description: Battery Low Notification with auto dismiss
  triggers:
    - trigger: event
      event_type: battery_notes_battery_threshold
      event_data:
        battery_low: true
      id: low
      alias: Battery went low
    - trigger: event
      event_type: battery_notes_battery_threshold
      event_data:
        battery_low: false
      id: high
      alias: Battery went high
  condition: []
  action:
    - choose:
        - conditions:
            - condition: trigger
              id:
                - low
          sequence:
            - action: persistent_notification.create
              data:
                title: |
                  {{ trigger.event.data.device_name }} Battery Low
                notification_id: "{{ trigger.event.data.device_id }}-{{ trigger.event.data.source_entity_id }}"
                message: >
                  The device has a battery level of {{
                  trigger.event.data.battery_level }}% {{ '\n' -}} You need {{
                  trigger.event.data.battery_quantity }}× {{
                  trigger.event.data.battery_type }}
        - conditions:
            - condition: trigger
              id:
                - high
          sequence:
            - action: persistent_notification.dismiss
              data:
                notification_id: "{{ trigger.event.data.device_id }}-{{ trigger.event.data.source_entity_id }}"
  mode: queued

- id: "17692637855442387"
  alias: "Button press on remote"
  mode: single
  triggers:
    - trigger: device
      device_id: b91c3dd0f0e777342b0b6792efcb8dff
      domain: bthome
      type: button
      subtype: press
  action:
    - action: light.turn_off
      target:
        entity_id: light.every_light
    - delay: 1
    - action: light.turn_on
      target:
        entity_id: light.tv_ambient_lights
- id: "1938466447855442387"
  alias: "Office Occupancy Lights"
  triggers:
    - trigger: state
      entity_id: binary_sensor.office_motion_sensors
      from: "off"
      to: "on"
    - type: occupied
      device_id: 66bf747d7602dd0c9f8320299e66f1df
      entity_id: 67cb3789db2356f8ed82959441d19e4e
      domain: binary_sensor
      trigger: device
  condition:
    - condition: state
      entity_id: input_boolean.motion_lights
      state: "off"
    - condition: state
      entity_id: input_boolean.naptime
      state: "off"
  action:
    - choose:
        - conditions:
            - condition: time
              before: "20:29:59"
              after: 09:00:01
            - condition: state
              entity_id: light.office_lights
              state: "off"
          sequence:
            - action: light.turn_on
              data:
                brightness_pct: 30
              target:
                entity_id: light.office_lights
        - conditions:
            - condition: time
              before: "23:59:00"
              after: "20:30:00"
            - condition: state
              entity_id: light.office_lights
              state: "off"
          sequence:
            - action: light.turn_on
              data:
                brightness_pct: 5
              target:
                entity_id: light.office_lights
        - conditions:
            - condition: time
              before: "09:00:00"
              after: "23:59:01"
          sequence:
            - delay: 300
    - wait_for_trigger:
        - type: not_occupied
          device_id: 66bf747d7602dd0c9f8320299e66f1df
          entity_id: 67cb3789db2356f8ed82959441d19e4e
          domain: binary_sensor
          trigger: device
          for:
            seconds: 15
    - action: light.turn_off
      entity_id: light.office_lights
  mode: restart
  max_exceeded: silent
- id: "17976441155444526"
  alias: AC on turn ON HVAC mister
  mode: single
  triggers:
    - trigger: state
      entity_id:
        - sensor.hvac_mode
      to: cooling
  condition:
    not:
      - condition: state
        entity_id: binary_sensor.night
        state: "on"
      - condition: state
        entity_id: weather.home
        state: "rainy"
      - condition: numeric_state
        entity_id: sensor.outside_recent_temperature
        below: 78
  action:
    - action: switch.turn_on
      entity_id: switch.hvac_mister_2
- id: "179794371155444526"
  alias: AC off turn OFF HVAC mister
  mode: single
  triggers:
    - trigger: state
      entity_id:
        - sensor.hvac_mode
      to: idle
      for:
        seconds: 60
  condition:
    - condition: state
      entity_id: switch.hvac_mister_2
      state: "on"
  action:
    - action: switch.turn_off
      entity_id: switch.hvac_mister_2
## kitchen remote 2 buttons
- id: "180794371155444526"
  alias: kitchen remote button 1
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_1
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.kitchen_ceiling_lights_3
- id: "186684371155444526"
  alias: kitchen remote button 1
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_1
      subtype: double_press
  action:
    - action: light.turn_on
      data:
        entity_id: light.kitchen_ceiling_lights_3
        brightness_pct: 25
- id: "187778371155444526"
  alias: kitchen remote button 1
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_1
      subtype: long_press
  action:
    - action: light.toggle
      data:
        entity_id: light.sofa_lamp

- id: "181294371155444526"
  alias: kitchen remote button 2
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_2
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.cabinet_lights_3
- id: "1817854671155444526"
  alias: kitchen remote button 2
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_2
      subtype: long_press
  action:
    - action: light.toggle
      data:
        entity_id: light.fireplace_lights
- id: "183294371155444526"
  alias: kitchen remote button 3
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_3
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.table_light
- id: "1848376113711554445"
  alias: kitchen remote button 4
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_4
      subtype: press
  action:
    - action: light.turn_off
      target:
        entity_id: light.kitchen_lights
- id: "184794371155444526"
  alias: kitchen remote button 4
  mode: single
  triggers:
    - trigger: device
      device_id: 5089e3c96fa21a53fa7baa762b008778
      domain: bthome
      type: button_4
      subtype: long_press
  action:
    - action: light.turn_off
      target:
        entity_id: light.every_light
    - delay:
        milliseconds: 500
    - action: light.turn_on
      target:
        entity_id: light.tv_ambient_lights

## kitchen remote 1 buttons
- id: "190794371155444526"
  alias: kitchen remote 1 button 1
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_1
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.kitchen_ceiling_lights_3
- id: "196684371155444526"
  alias: kitchen remote 1 button 1
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_1
      subtype: double_press
  action:
    - action: light.turn_on
      data:
        entity_id: light.kitchen_ceiling_lights_3
        brightness_pct: 25
- id: "197778371155444526"
  alias: kitchen remote 1 button 1
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_1
      subtype: long_press
  action:
    - action: light.turn_on
      data:
        entity_id: light.kitchen_ceiling_lights_3
        brightness_pct: 100

- id: "191294371155444526"
  alias: kitchen remote 1 button 2
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_2
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.cabinet_lights_3
- id: "193294371155444526"
  alias: kitchen remote 1 button 3
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_3
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.table_light
- id: "194594371155444526"
  alias: kitchen remote 1 button 3
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_3
      subtype: long_press
  action:
    - action: input_boolean.turn_on
      target:
        entity_id: input_boolean.romance_time
- id: "1944488884371155444526"
  alias: kitchen remote 1 button 4
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_4
      subtype: press
  action:
    - action: light.turn_off
      target:
        entity_id: light.kitchen_lights
- id: "194794371155444526"
  alias: kitchen remote 1 button 4
  mode: single
  triggers:
    - trigger: device
      device_id: 8d5ed8bf9702b9d30766b381026f1fd3
      domain: bthome
      type: button_4
      subtype: long_press
  action:
    - action: light.turn_off
      target:
        entity_id: light.every_light
    - delay:
        milliseconds: 500
    - action: light.turn_on
      target:
        entity_id: light.tv_ambient_lights

## bedroom remote buttons
- id: "191114371155444526"
  alias: bedroom remote button 1
  mode: single
  triggers:
    - trigger: device
      device_id: adb14876079214910d4e2e8f2cf6fbf2
      domain: bthome
      type: button_1
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.nightstand_lamps
- id: "1912124371155444526"
  alias: bedroom remote button 1
  mode: single
  triggers:
    - trigger: device
      device_id: adb14876079214910d4e2e8f2cf6fbf2
      domain: bthome
      type: button_1
      subtype: long_press
  action:
    - action: light.turn_on
      data:
        rgb_color:
          - 255
          - 0
          - 0
        brightness_pct: 16
      target:
        entity_id: light.nightstand_lamps
- id: "1934224371155444526"
  alias: bedroom remote button 1
  mode: single
  triggers:
    - trigger: device
      device_id: adb14876079214910d4e2e8f2cf6fbf2
      domain: bthome
      type: button_1
      subtype: double_press
  action:
    - action: light.turn_on
      data:
        color_temp_kelvin: 3000
        brightness_pct: 15
      target:
        entity_id: light.nightstand_lamps
- id: "192224371155444526"
  alias: bedroom remote button 2
  mode: single
  triggers:
    - trigger: device
      device_id: adb14876079214910d4e2e8f2cf6fbf2
      domain: bthome
      type: button_2
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.bedroom_ceiling
- id: "193334371155444526"
  alias: bedroom remote button 3
  mode: single
  triggers:
    - trigger: device
      device_id: adb14876079214910d4e2e8f2cf6fbf2
      domain: bthome
      type: button_3
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.mood_lights
- id: "194444371155444526"
  alias: bedroom remote button 4
  mode: single
  triggers:
    - trigger: device
      device_id: adb14876079214910d4e2e8f2cf6fbf2
      domain: bthome
      type: button_4
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.bedroom_lights
## den remote buttons
- id: "199214371158797223"
  alias: den remote button 1
  mode: single
  triggers:
    - trigger: device
      device_id: 8fcbe6652dc5f7737c49fda014896978
      domain: bthome
      type: button_1
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.foyer_lights
- id: "192222271158797223"
  alias: den remote button 2
  mode: single
  triggers:
    - trigger: device
      device_id: 8fcbe6652dc5f7737c49fda014896978
      domain: bthome
      type: button_2
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.porch_light
- id: "19768676271158797223"
  alias: den remote button 3
  mode: single
  triggers:
    - trigger: device
      device_id: 8fcbe6652dc5f7737c49fda014896978
      domain: bthome
      type: button_3
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.outside_lights
- id: "194444371158797223"
  alias: den remote button 4
  mode: single
  triggers:
    - trigger: device
      device_id: 8fcbe6652dc5f7737c49fda014896978
      domain: bthome
      type: button_4
      subtype: press
  action:
    - action: light.toggle
      target:
        entity_id: light.den_lights
- id: "1908754371155444526"
  alias: den remote button 4
  mode: single
  triggers:
    - trigger: device
      device_id: 8fcbe6652dc5f7737c49fda014896978
      domain: bthome
      type: button_4
      subtype: long_press
  action:
    - action: light.turn_off
      target:
        entity_id: light.every_light
    - delay:
        milliseconds: 500
    - action: light.turn_on
      target:
        entity_id: light.tv_ambient_lights
## patio remote buttons
- id: "2012143711587972238"
  alias: patio remote button 1
  mode: single
  triggers:
    - device_id: 678ee59e9221d02b1ee09145dd4183f1
      domain: bthome
      type: button_1
      subtype: press
      trigger: device
  actions:
    - action: light.toggle
      target:
        entity_id: light.patio_led_lights
- id: "201214371158797223822"
  alias: patio remote button 2
  mode: single
  triggers:
    - device_id: 678ee59e9221d02b1ee09145dd4183f1
      domain: bthome
      type: button_2
      subtype: press
      trigger: device
  actions:
    - action: switch.toggle
      target:
        entity_id: switch.patio_fountain_plug
- id: "201214371158797223833"
  alias: patio remote button 3
  mode: single
  triggers:
    - device_id: 678ee59e9221d02b1ee09145dd4183f1
      domain: bthome
      type: button_3
      subtype: press
      trigger: device
  actions:
    - action: input_boolean.toggle
      target:
        entity_id: input_boolean.patio_mister_switch
- id: "201214371158797223844"
  alias: patio remote button 4
  mode: single
  triggers:
    - device_id: 678ee59e9221d02b1ee09145dd4183f1
      domain: bthome
      type: button_4
      subtype: press
      trigger: device
  actions:
    - action: light.toggle
      target:
        entity_id: light.outside_lights
- id: "17326181774975112345"
  alias: "[SWITCH] Patio Mister ON/OFF cycle"
  triggers:
    - trigger: state
      entity_id: input_boolean.patio_mister_switch
      to: "on"
  action:
    - action: fan.turn_on
      entity_id: fan.patio_fan
    - repeat:
        sequence:
          - action: switch.turn_on
            entity_id: switch.patio_mister_2
          - delay:
              seconds: 10
          - action: switch.turn_off
            entity_id: switch.patio_mister_2
          - delay:
              seconds: 50
        until:
          - condition: state
            entity_id: input_boolean.patio_mister_switch
            state: "off"
    - action: fan.turn_off
      entity_id: fan.patio_fan
  initial_state: true
- id: "17776181774975112345"
  alias: "[SWITCH] Patio Mister time limit"
  triggers:
    - trigger: state
      entity_id: input_boolean.patio_mister_switch
      to: "on"
      for:
        minutes: 10
  action:
    - action: input_boolean.turn_off
      entity_id: input_boolean.patio_mister_switch
  mode: single

- id: "20126181775112345"
  alias: "[SWITCH] Office Fan cycle"
  triggers:
    - trigger: state
      entity_id: input_boolean.office_fan_cycles
      to: "on"
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: light.office_ceiling_fan
              state: "on"
          sequence:
            - repeat:
                sequence:
                  - delay:
                      seconds: 120
                  - action: fan.turn_off
                    entity_id: fan.office_fan
                  - delay:
                      minutes: 8
                  - action: fan.turn_on
                    entity_id: fan.office_fan
                until:
                  - condition: state
                    entity_id: input_boolean.office_fan_cycles
                    state: "off"
        - conditions:
            - condition: state
              entity_id: light.office_ceiling_fan
              state: "off"
          sequence:
            - action: light.turn_on
              entity_id: light.office_ceiling_fan
            - repeat:
                sequence:
                  - delay:
                      seconds: 120
                  - action: fan.turn_off
                    entity_id: fan.office_fan
                  - delay:
                      minutes: 8
                  - action: fan.turn_on
                    entity_id: fan.office_fan
                until:
                  - condition: state
                    entity_id: input_boolean.office_fan_cycles
                    state: "off"
  initial_state: true

- id: "201261817757785345"
  alias: "[SWITCH] Guest Fan cycle"
  triggers:
    - trigger: state
      entity_id: input_boolean.guest_fan_cycles
      to: "on"
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: fan.guest_fan
              state: "on"
          sequence:
            - repeat:
                sequence:
                  - delay:
                      minutes: 10
                  - action: fan.turn_off
                    entity_id: fan.guest_fan
                  - delay:
                      minutes: 10
                  - action: fan.turn_on
                    entity_id: fan.guest_fan
                until:
                  - condition: state
                    entity_id: input_boolean.guest_fan_cycles
                    state: "off"
        - conditions:
            - condition: state
              entity_id: fan.guest_fan
              state: "off"
          sequence:
            - action: fan.turn_on
              entity_id: fan.guest_fan
            - repeat:
                sequence:
                  - delay:
                      minutes: 10
                  - action: fan.turn_off
                    entity_id: fan.guest_fan
                  - delay:
                      minutes: 10
                  - action: fan.turn_on
                    entity_id: fan.guest_fan
                until:
                  - condition: state
                    entity_id: input_boolean.guest_fan_cycles
                    state: "off"
  initial_state: true

- id: "3121261817755342345"
  alias: "[SWITCH] Den Fan cycle"
  triggers:
    - trigger: state
      entity_id: input_boolean.den_fan_cycles
      to: "on"
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: fan.den_fan
              state: "on"
          sequence:
            - repeat:
                sequence:
                  - delay:
                      seconds: 180
                  - action: fan.turn_off
                    entity_id: fan.den_fan
                  - delay:
                      seconds: 80
                  - action: fan.turn_on
                    entity_id: fan.den_fan
                until:
                  - condition: state
                    entity_id: input_boolean.den_fan_cycles
                    state: "off"
        - conditions:
            - condition: state
              entity_id: fan.den_fan
              state: "off"
          sequence:
            - action: fan.turn_on
              entity_id: fan.den_fan
            - repeat:
                sequence:
                  - delay:
                      seconds: 180
                  - action: fan.turn_off
                    entity_id: fan.den_fan
                  - delay:
                      seconds: 40
                  - action: fan.turn_on
                    entity_id: fan.den_fan
                until:
                  - condition: state
                    entity_id: input_boolean.den_fan_cycles
                    state: "off"
  initial_state: true

- id: "202946321485676354"
  alias: "[TIMER] Toothbrush Charger"
  triggers:
    - trigger: time
      at: "02:30:00"
  action:
    - action: switch.turn_on
      target:
        entity_id: switch.bathroom_night_light_plug
    - delay:
        minutes: 20
    - action: switch.turn_off
      target:
        entity_id: switch.bathroom_night_light_plug
  initial_state: true
- id: "203005432198623276354"
  triggers:
    - trigger: template
      value_template: >-
        {{ states('sensor.date_time') ==
        (as_timestamp(states.sensor.pixel_8_pro_next_alarm.state) |int -1)|
        timestamp_custom('%Y-%m-%d, %H:%M', True) }}
  mode: single
  conditions:
    - condition: template
      value_template: "{{ trigger.from_state.state != 'unavailable' }}"
    - condition: state
      entity_id: input_boolean.darren_s_alarm_triggered_today
      state: "off"
    - condition: state
      entity_id: person.darren
      state: home
  actions:
    - variables:
        weather_entity: weather.home
        calendar_entity: calendar.dwilson_churchoftheking_com
        zone_entity: zone.home
        calendar_duration:
          hours: 24
        prompt: >-
          Please generate text for a notification that will be sent to Darren's bedside speaker with helpful information to start off his day.

          You are a helpful personal agent that generates a spoken response for Darren:

          - Your answers are helpful, friendly, warm, insightful.

          - Respond using a warm tone that is inviting, with a hint of mischief.

          - You should always include current time in 12 hour format, temperature, humidity and today's weather forecast.

          - You should always include a short, but inspirational bible verse.

          - Your answers are not technical, and do not include Home Assistant internal details such as entities in responses.

          - Your messages help Darren prepare for his day, for example:
            - Making note of unusual weather for the location and time of year (but not mundane details like "0% chance of precipitation")
            - How much time remaining until their first meeting
            - Anything that may be special or unique, such as celebrating a birthday
    - alias: Fetch Weather Forecast
      action: weather.get_forecasts
      data:
        type: hourly
      target:
        entity_id:
          - "{{ weather_entity }}"
      response_variable: daily_forecast
    - variables:
        forecast_entity: "{{ daily_forecast[weather_entity] }}"
        forecast: "{{ forecast_entity.forecast[0] }}"
    - alias: Fetch Calendar Agenda
      action: calendar.get_events
      data:
        duration:
          hours: 24
      target:
        entity_id: calendar.dwilson_churchoftheking_com
      response_variable: events_response
    - alias: Conversation Agent Notification Text
      action: conversation.process
      data:
        text: >-
          Time: {{ now().strftime("%A %B %d %H:%M %p") }}

          {%- if weather_entity is defined %}

          {%- set temperature_unit = state_attr(weather_entity,
          'temperature_unit') -%}

          Forecast: {{ forecast.condition }} ({{ forecast.temperature }}{{
          temperature_unit }}, {{ forecast.precipitation }}% precipitation)

          {%- endif %}


          Calendar "{{ state_attr(calendar_entity, 'friendly_name') }}" events for
          the next {{ calendar_duration.hours }} hours:

          {%- set agenda = (events_response | items | first)[1] %}

          {%- if agenda.events %}
            {%- for event in agenda.events %}
            - Summary: {{ event.summary }}
              Start-End: {% if event.start is defined %}{{ event.start }} to {{ event.end }}{% else %}All Day{% endif %}
              {%- if event.description is defined %}
              Description: {{ event.description }}
              {% endif -%}
              {%- if event.location is defined %}
                Location: {{ event.location }}
              {% endif -%}
            {%- endfor %}
          {%- else %}
            - No upcoming events.
          {%- endif %}


          {{ prompt }}
        agent_id: e181a3af361f399aaf5b0703856e124b
      response_variable: agent
    - alias: Send notification
      action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id:
          - media_player.office_display
        volume_level: 0.1
    - action: tts.cloud_say
      continue_on_error: true
      entity_id:
        - media_player.office_display
      data_template:
        message: "{{ agent.response.speech.plain.speech }}"
  alias: "Daily Info AI Testing"
  description: ""

- id: "203305432198623285254"
  triggers:
    - trigger: template
      value_template: >-
        {{ states('sensor.date_time') ==
        (as_timestamp(states.sensor.pixel_8_pro_next_alarm.state) |int -1)|
        timestamp_custom('%Y-%m-%d, %H:%M', True) }}
  mode: single
  actions:
    - alias: Conversation Agent Notification TTS
      action: conversation.process
      data:
        text: >-
          What is the current time, weather conditions and forecast for today?

          - You should always include current time in 12 hour format, temperature and humidity and current weather forecast.

          Any events on my calanders for over the next 18 hours?

          - How much time remaining until their first meeting

          - Anything that may be special or unique, such as celebrating a birthday

          Please give me a short, but inspirational bible verse.

          Send this information to my phone.
        agent_id: e181a3af361f399aaf5b0703856e124b
      response_variable: agent
    - alias: Send notification
      action: media_player.volume_set
      continue_on_error: true
      data:
        entity_id:
          - media_player.office_display
        volume_level: 0.1
    - action: tts.cloud_say
      continue_on_error: true
      entity_id:
        - media_player.office_display
      data_template:
        message: "{{ agent.response.speech.plain.speech }}"
  alias: "Daily TTS AI Testing"
  description: ""

- id: "204446321485676354"
  alias: "Sleep track announce"
  description: ""
  mode: single
  use_blueprint:
    path: IATkachenko/full.yaml
    input:
      device: 11f7d4c43d0425242be095e2da738148
      person: person.darren
      sleep_tracking_started:
        - action: assist_satellite.announce
          metadata: {}
          data:
            message: sleep tracking started
          target:
            device_id: c9ec3cc293f9997730f69821b949bae1
      sleep_tracking_stopped:
        - action: assist_satellite.announce
          metadata: {}
          data:
            message: sleep tracking stopped, awake now
          target:
            entity_id: assist_satellite.home_assistant_voice_095e78_assist_satellite
